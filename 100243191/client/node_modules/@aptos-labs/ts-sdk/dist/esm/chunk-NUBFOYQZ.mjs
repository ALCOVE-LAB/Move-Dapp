import{b as E}from"./chunk-GTCDSGOA.mjs";import{a as v}from"./chunk-CUWAGKEP.mjs";import{d as p,f,g as K,h as A,i as H,j as P}from"./chunk-LR65XHSF.mjs";import{a as h}from"./chunk-RZNFFGTD.mjs";import{a as g}from"./chunk-W2XLZW4Y.mjs";import{b as i}from"./chunk-BZMO6Q6L.mjs";import o from"tweetnacl";var n=class n extends E{constructor(e){super();let t=i.fromHexInput(e);if(t.toUint8Array().length!==n.LENGTH)throw new Error(`PublicKey length should be ${n.LENGTH}`);this.key=t}verifySignature(e){let{message:t,signature:s}=e;if(!(s instanceof y))return!1;let c=i.fromHexInput(t).toUint8Array(),u=s.toUint8Array(),l=this.key.toUint8Array();return o.sign.detached.verify(c,u,l)}authKey(){return h.fromSchemeAndBytes({scheme:0,input:this.toUint8Array()})}toUint8Array(){return this.key.toUint8Array()}serialize(e){e.serializeBytes(this.key.toUint8Array())}static deserialize(e){let t=e.deserializeBytes();return new n(t)}static isPublicKey(e){return e instanceof n}};n.LENGTH=32;var m=n,r=class r extends g{constructor(e){super();let t=i.fromHexInput(e);if(t.toUint8Array().length!==r.LENGTH)throw new Error(`PrivateKey length should be ${r.LENGTH}`);this.signingKeyPair=o.sign.keyPair.fromSeed(t.toUint8Array().slice(0,r.LENGTH))}static generate(){let e=o.sign.keyPair();return new r(e.secretKey.slice(0,r.LENGTH))}static fromDerivationPath(e,t){if(!f(e))throw new Error(`Invalid derivation path ${e}`);return r.fromDerivationPathInner(e,P(t))}static fromDerivationPathInner(e,t,s=p){let{key:c,chainCode:u}=K(r.SLIP_0010_SEED,t),l=H(e).map(d=>parseInt(d,10)),{key:x}=l.reduce((d,U)=>A(d,U+s),{key:c,chainCode:u});return new r(x)}publicKey(){let e=this.signingKeyPair.publicKey;return new m(e)}sign(e){let t=i.fromHexInput(e).toUint8Array(),s=o.sign.detached(t,this.signingKeyPair.secretKey);return new y(s)}toUint8Array(){return this.signingKeyPair.secretKey.slice(0,r.LENGTH)}toString(){return i.fromHexInput(this.toUint8Array()).toString()}serialize(e){e.serializeBytes(this.toUint8Array())}static deserialize(e){let t=e.deserializeBytes();return new r(t)}static isPrivateKey(e){return e instanceof r}};r.LENGTH=32,r.SLIP_0010_SEED="ed25519 seed";var S=r,a=class a extends v{constructor(e){super();let t=i.fromHexInput(e);if(t.toUint8Array().length!==a.LENGTH)throw new Error(`Signature length should be ${a.LENGTH}`);this.data=t}toUint8Array(){return this.data.toUint8Array()}serialize(e){e.serializeBytes(this.data.toUint8Array())}static deserialize(e){let t=e.deserializeBytes();return new a(t)}};a.LENGTH=64;var y=a;export{m as a,S as b,y as c};
//# sourceMappingURL=chunk-NUBFOYQZ.mjs.map