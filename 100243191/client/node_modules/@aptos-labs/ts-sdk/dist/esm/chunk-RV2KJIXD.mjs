import{a as A}from"./chunk-AH44UPM4.mjs";import{a as d}from"./chunk-3JPVQHOR.mjs";import{i as w,j as C}from"./chunk-SOFGN24M.mjs";import{b as c,c as l}from"./chunk-RQSMDDYP.mjs";import{a as h}from"./chunk-GHYE26Q5.mjs";import{d as y}from"./chunk-HEPV52CH.mjs";async function F(s){let{aptosConfig:n,options:t}=s;return l({aptosConfig:n,originMethod:"getTransactions",path:"transactions",params:{start:t?.offset,limit:t?.limit}})}async function L(s){let{aptosConfig:n}=s;return A(async()=>{let{data:t}=await c({aptosConfig:n,originMethod:"getGasPriceEstimation",path:"estimate_gas_price"});return t},`gas-price-${n.network}`,1e3*60*5)()}async function v(s){let{aptosConfig:n,ledgerVersion:t}=s,{data:o}=await c({aptosConfig:n,originMethod:"getTransactionByVersion",path:`transactions/by_version/${t}`});return o}async function x(s){let{aptosConfig:n,transactionHash:t}=s,{data:o}=await c({aptosConfig:n,path:`transactions/by_hash/${t}`,originMethod:"getTransactionByHash"});return o}async function N(s){let{aptosConfig:n,transactionHash:t}=s;try{return(await x({aptosConfig:n,transactionHash:t})).type==="pending_transaction"}catch(o){if(o?.status===404)return!0;throw o}}async function G(s){let{aptosConfig:n,transactionHash:t,options:o}=s,r=o?.timeoutSecs??20,f=o?.checkSuccess??!0,i=!0,u=0,e,g,m=200,P=1.5;for(;i&&!(u>=r);){try{if(e=await x({aptosConfig:n,transactionHash:t}),i=e.type==="pending_transaction",!i)break}catch(a){if(!(a instanceof h)||(g=a,a.status!==404&&a.status>=400&&a.status<500))throw a}await d(m),u+=m/1e3,m*=P}if(e===void 0)throw g||new p(`Fetching transaction ${t} failed and timed out after ${r} seconds`,e);if(e.type==="pending_transaction")throw new p(`Transaction ${t} timed out in pending state after ${r} seconds`,e);if(!f)return e;if(!e.success)throw new T(`Transaction ${t} failed with an error: ${e.vm_status}`,e);return e}async function D(s){let{aptosConfig:n,processorType:t}=s,o=BigInt(s.minimumLedgerVersion),r=3e3,f=new Date().getTime(),i=BigInt(-1);for(;i<o;){if(new Date().getTime()-f>r)throw new Error("waitForLastSuccessIndexerVersionSync timeout");if(t===void 0?i=await w({aptosConfig:n}):i=(await C({aptosConfig:n,processorType:t})).last_success_version,i>=o)break;await d(200)}}var p=class extends Error{constructor(n,t){super(n),this.lastSubmittedTransaction=t}},T=class extends Error{constructor(n,t){super(n),this.transaction=t}};export{F as a,L as b,v as c,x as d,N as e,G as f,D as g,p as h,T as i};
//# sourceMappingURL=chunk-RV2KJIXD.mjs.map