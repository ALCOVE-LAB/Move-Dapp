"use strict";Object.defineProperty(exports, "__esModule", {value: true}); function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { newObj[key] = obj[key]; } } } newObj.default = obj; return newObj; } } function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; } function _nullishCoalesce(lhs, rhsFn) { if (lhs != null) { return lhs; } else { return rhsFn(); } } function _optionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = fn(value); } else if (op === 'call' || op === 'optionalCall') { value = fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; } async function _asyncOptionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = await fn(value); } else if (op === 'call' || op === 'optionalCall') { value = await fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; }var Vs=Object.defineProperty;var Hs=Object.getOwnPropertyDescriptor;var M=(n,e,t,r)=>{for(var o=r>1?void 0:r?Hs(e,t):e,s=n.length-1,i;s>=0;s--)(i=n[s])&&(o=(r?i(e,t,o):i(o))||o);return r&&o&&Vs(e,t,o),o};var ye=class extends Error{constructor(e,t,r){super(r),this.name="AptosApiError",this.url=t.url,this.status=t.status,this.statusText=t.statusText,this.data=t.data,this.request=e}};var wr="1.10.0";var Rn=(r=>(r.JSON="application/json",r.BCS="application/x-bcs",r.BCS_SIGNED_TRANSACTION="application/x.aptos.signed_transaction+bcs",r))(Rn||{}),_r= exports.TypeTagVariants =(g=>(g[g.Bool=0]="Bool",g[g.U8=1]="U8",g[g.U64=2]="U64",g[g.U128=3]="U128",g[g.Address=4]="Address",g[g.Signer=5]="Signer",g[g.Vector=6]="Vector",g[g.Struct=7]="Struct",g[g.U16=8]="U16",g[g.U32=9]="U32",g[g.U256=10]="U256",g[g.Reference=254]="Reference",g[g.Generic=255]="Generic",g))(_r||{}),Tt= exports.ScriptTransactionArgumentVariants =(p=>(p[p.U8=0]="U8",p[p.U64=1]="U64",p[p.U128=2]="U128",p[p.Address=3]="Address",p[p.U8Vector=4]="U8Vector",p[p.Bool=5]="Bool",p[p.U16=6]="U16",p[p.U32=7]="U32",p[p.U256=8]="U256",p))(Tt||{}),Sr= exports.TransactionPayloadVariants =(r=>(r[r.Script=0]="Script",r[r.EntryFunction=2]="EntryFunction",r[r.Multisig=3]="Multisig",r))(Sr||{}),xr= exports.TransactionVariants =(t=>(t[t.MultiAgentTransaction=0]="MultiAgentTransaction",t[t.FeePayerTransaction=1]="FeePayerTransaction",t))(xr||{}),vr= exports.TransactionAuthenticatorVariant =(s=>(s[s.Ed25519=0]="Ed25519",s[s.MultiEd25519=1]="MultiEd25519",s[s.MultiAgent=2]="MultiAgent",s[s.FeePayer=3]="FeePayer",s[s.SingleSender=4]="SingleSender",s))(vr||{}),Cr= exports.AccountAuthenticatorVariant =(o=>(o[o.Ed25519=0]="Ed25519",o[o.MultiEd25519=1]="MultiEd25519",o[o.SingleKey=2]="SingleKey",o[o.MultiKey=3]="MultiKey",o))(Cr||{}),Pr= exports.AnyPublicKeyVariant =(t=>(t[t.Ed25519=0]="Ed25519",t[t.Secp256k1=1]="Secp256k1",t))(Pr||{}),Er= exports.AnySignatureVariant =(t=>(t[t.Ed25519=0]="Ed25519",t[t.Secp256k1=1]="Secp256k1",t))(Er||{}),Nn= exports.TransactionResponseType =(i=>(i.Pending="pending_transaction",i.User="user_transaction",i.Genesis="genesis_transaction",i.BlockMetadata="block_metadata_transaction",i.StateCheckpoint="state_checkpoint_transaction",i.Validator="validator_transaction",i))(Nn||{});function aa(n){return n.type==="pending_transaction"}function ca(n){return n.type==="user_transaction"}function ua(n){return n.type==="genesis_transaction"}function pa(n){return n.type==="block_metadata_transaction"}function da(n){return n.type==="state_checkpoint_transaction"}function la(n){return n.type==="validator_transaction"}function ga(n){return"signature"in n&&n.signature==="ed25519_signature"}function ma(n){return"signature"in n&&n.signature==="secp256k1_ecdsa_signature"}function ya(n){return n.type==="multi_agent_signature"}function Aa(n){return n.type==="fee_payer_signature"}function fa(n){return n.type==="multi_ed25519_signature"}var Qs=(r=>(r.PRIVATE="private",r.PUBLIC="public",r.FRIEND="friend",r))(Qs||{}),Ir= exports.MoveAbility =(o=>(o.STORE="store",o.DROP="drop",o.KEY="key",o.COPY="copy",o))(Ir||{}),Ws= exports.RoleType =(t=>(t.VALIDATOR="validator",t.FULL_NODE="full_node",t))(Ws||{}),xe= exports.SigningScheme =(o=>(o[o.Ed25519=0]="Ed25519",o[o.MultiEd25519=1]="MultiEd25519",o[o.SingleKey=2]="SingleKey",o[o.MultiKey=3]="MultiKey",o))(xe||{}),Gn= exports.SigningSchemeInput =(t=>(t[t.Ed25519=0]="Ed25519",t[t.Secp256k1Ecdsa=2]="Secp256k1Ecdsa",t))(Gn||{}),js= exports.DeriveScheme =(s=>(s[s.DeriveAuid=251]="DeriveAuid",s[s.DeriveObjectAddressFromObject=252]="DeriveObjectAddressFromObject",s[s.DeriveObjectAddressFromGuid=253]="DeriveObjectAddressFromGuid",s[s.DeriveObjectAddressFromSeed=254]="DeriveObjectAddressFromSeed",s[s.DeriveResourceAccountAddress=255]="DeriveResourceAccountAddress",s))(js||{});var Ur={400:"Bad Request",401:"Unauthorized",403:"Forbidden",404:"Not Found",429:"Too Many Requests",500:"Internal Server Error",502:"Bad Gateway",503:"Service Unavailable"};async function Xs(n,e){let{url:t,method:r,body:o,contentType:s,params:i,overrides:a}=n,c={..._optionalChain([a, 'optionalAccess', _2 => _2.HEADERS]),"x-aptos-client":`aptos-typescript-sdk/${wr}`,"content-type":_nullishCoalesce(s, () => ("application/json"))};return _optionalChain([a, 'optionalAccess', _3 => _3.AUTH_TOKEN])&&t.includes("faucet")&&(c.Authorization=`Bearer ${_optionalChain([a, 'optionalAccess', _4 => _4.AUTH_TOKEN])}`),_optionalChain([a, 'optionalAccess', _5 => _5.API_KEY])&&!t.includes("faucet")&&(c.Authorization=`Bearer ${_optionalChain([a, 'optionalAccess', _6 => _6.API_KEY])}`),e.provider({url:t,method:r,body:o,params:i,headers:c,overrides:a})}async function qt(n,e){let{url:t,path:r}=n,o=r?`${t}/${r}`:t,s=await Xs({...n,url:o},e.client),i={status:s.status,statusText:s.statusText,data:s.data,headers:s.headers,config:s.config,request:s.request,url:o};if(e.isIndexerRequest(t)){let c=i.data;if(c.errors)throw new ye(n,i,_nullishCoalesce(`Indexer error: ${c.errors[0].message}`, () => (`Indexer unhandled Error ${s.status} : ${s.statusText}`)));i.data=c.data}if(i.status>=200&&i.status<300)return i;let a;throw i&&i.data&&"message"in i.data&&"error_code"in i.data?a=JSON.stringify(i.data):i.status in Ur?a=Ur[i.status]:a=`Unhandled Error ${i.status} : ${i.statusText}`,new ye(n,i,`${e.isFullnodeRequest(t)?"Fullnode":"Faucet"} error: ${a}`)}var $t=(r=>(r[r.FULLNODE=0]="FULLNODE",r[r.INDEXER=1]="INDEXER",r[r.FAUCET=2]="FAUCET",r))($t||{}),Rr= exports.DEFAULT_MAX_GAS_AMOUNT =2e5,Nr= exports.DEFAULT_TXN_EXP_SEC_FROM_NOW =20,Lt= exports.DEFAULT_TXN_TIMEOUT_SEC =20,Vt= exports.APTOS_COIN ="0x1::aptos_coin::AptosCoin",Gr= exports.RAW_TRANSACTION_SALT ="APTOS::RawTransaction",kn= exports.RAW_TRANSACTION_WITH_DATA_SALT ="APTOS::RawTransactionWithData",Le= exports.ProcessorType =(a=>(a.ACCOUNT_TRANSACTION_PROCESSOR="account_transactions_processor",a.DEFAULT="default_processor",a.EVENTS_PROCESSOR="events_processor",a.FUNGIBLE_ASSET_PROCESSOR="fungible_asset_processor",a.STAKE_PROCESSOR="stake_processor",a.TOKEN_V2_PROCESSOR="token_v2_processor",a.USER_TRANSACTION_PROCESSOR="user_transaction_processor",a))(Le||{});async function kr(n){let{aptosConfig:e,overrides:t,params:r,contentType:o,acceptType:s,path:i,originMethod:a,type:c}=n,p=e.getRequestUrl(c);return qt({url:p,method:"GET",originMethod:a,path:i,contentType:_optionalChain([o, 'optionalAccess', _7 => _7.valueOf, 'call', _8 => _8()]),acceptType:_optionalChain([s, 'optionalAccess', _9 => _9.valueOf, 'call', _10 => _10()]),params:r,overrides:{...e.clientConfig,...t}},e)}async function j(n){return kr({...n,type:0})}async function Ve(n){let e=[],t,r=n.params;do{let o=await kr({type:0,aptosConfig:n.aptosConfig,originMethod:n.originMethod,path:n.path,params:r,overrides:n.overrides});t=o.headers["x-aptos-cursor"],delete o.headers,e.push(...o.data),r.start=t}while(t!=null);return e}async function zn(n){let{type:e,originMethod:t,path:r,body:o,acceptType:s,contentType:i,params:a,aptosConfig:c,overrides:p}=n,f=c.getRequestUrl(e);return qt({url:f,method:"POST",originMethod:t,path:r,body:o,contentType:_optionalChain([i, 'optionalAccess', _11 => _11.valueOf, 'call', _12 => _12()]),acceptType:_optionalChain([s, 'optionalAccess', _13 => _13.valueOf, 'call', _14 => _14()]),params:a,overrides:{...c.clientConfig,...p}},c)}async function He(n){return zn({...n,type:0})}async function zr(n){return zn({...n,type:1})}async function Or(n){return zn({...n,type:2})}var _utils = require('@noble/hashes/utils');var Ht=255,Qt=65535,Ae=4294967295,ke=18446744073709551615n,bt=340282366920938463463374607431768211455n,Wt=115792089237316195423570985008687907853269984665640564039457584007913129639935n;var F=class extends Error{constructor(e,t){super(e),this.invalidReason=t}};var Js=(r=>(r.TOO_SHORT="too_short",r.INVALID_LENGTH="invalid_length",r.INVALID_HEX_CHARS="invalid_hex_chars",r))(Js||{}),b= exports.Hex =class n{constructor(e){this.data=e}toUint8Array(){return this.data}toStringWithoutPrefix(){return _utils.bytesToHex.call(void 0, this.data)}toString(){return`0x${this.toStringWithoutPrefix()}`}static fromString(e){let t=e;if(t.startsWith("0x")&&(t=t.slice(2)),t.length===0)throw new F("Hex string is too short, must be at least 1 char long, excluding the optional leading 0x.","too_short");if(t.length%2!==0)throw new F("Hex string must be an even number of hex characters.","invalid_length");try{return new n(_utils.hexToBytes.call(void 0, t))}catch(r){throw new F(`Hex string contains invalid hex characters: ${_optionalChain([r, 'optionalAccess', _15 => _15.message])}`,"invalid_hex_chars")}}static fromHexInput(e){return e instanceof Uint8Array?new n(e):n.fromString(e)}static isValid(e){try{return n.fromString(e),{valid:!0}}catch(t){return{valid:!1,invalidReason:_optionalChain([t, 'optionalAccess', _16 => _16.invalidReason]),invalidReasonMessage:_optionalChain([t, 'optionalAccess', _17 => _17.message])}}}equals(e){return this.data.length!==e.data.length?!1:this.data.every((t,r)=>t===e.data[r])}};var d=class{bcsToBytes(){let e=new ae;return this.serialize(e),e.toUint8Array()}bcsToHex(){let e=this.bcsToBytes();return b.fromHexInput(e)}},ae= exports.Serializer =class{constructor(e=64){if(e<=0)throw new Error("Length needs to be greater than 0");this.buffer=new ArrayBuffer(e),this.offset=0}ensureBufferWillHandleSize(e){for(;this.buffer.byteLength<this.offset+e;){let t=new ArrayBuffer(this.buffer.byteLength*2);new Uint8Array(t).set(new Uint8Array(this.buffer)),this.buffer=t}}appendToBuffer(e){this.ensureBufferWillHandleSize(e.length),new Uint8Array(this.buffer,this.offset).set(e),this.offset+=e.length}serializeWithFunction(e,t,r){this.ensureBufferWillHandleSize(t);let o=new DataView(this.buffer,this.offset);e.apply(o,[0,r,!0]),this.offset+=t}serializeStr(e){let t=new TextEncoder;this.serializeBytes(t.encode(e))}serializeBytes(e){this.serializeU32AsUleb128(e.length),this.appendToBuffer(e)}serializeFixedBytes(e){this.appendToBuffer(e)}serializeBool(e){On(e);let t=e?1:0;this.appendToBuffer(new Uint8Array([t]))}serializeU8(e){this.appendToBuffer(new Uint8Array([e]))}serializeU16(e){this.serializeWithFunction(DataView.prototype.setUint16,2,e)}serializeU32(e){this.serializeWithFunction(DataView.prototype.setUint32,4,e)}serializeU64(e){let t=BigInt(e)&BigInt(Ae),r=BigInt(e)>>BigInt(32);this.serializeU32(Number(t)),this.serializeU32(Number(r))}serializeU128(e){let t=BigInt(e)&ke,r=BigInt(e)>>BigInt(64);this.serializeU64(t),this.serializeU64(r)}serializeU256(e){let t=BigInt(e)&bt,r=BigInt(e)>>BigInt(128);this.serializeU128(t),this.serializeU128(r)}serializeU32AsUleb128(e){let t=e,r=[];for(;t>>>7;)r.push(t&127|128),t>>>=7;r.push(t),this.appendToBuffer(new Uint8Array(r))}toUint8Array(){return new Uint8Array(this.buffer).slice(0,this.offset)}serialize(e){e.serialize(this)}serializeVector(e){this.serializeU32AsUleb128(e.length),e.forEach(t=>{t.serialize(this)})}};M([ze(0,Ht)],ae.prototype,"serializeU8",1),M([ze(0,Qt)],ae.prototype,"serializeU16",1),M([ze(0,Ae)],ae.prototype,"serializeU32",1),M([ze(BigInt(0),ke)],ae.prototype,"serializeU64",1),M([ze(BigInt(0),bt)],ae.prototype,"serializeU128",1),M([ze(BigInt(0),Wt)],ae.prototype,"serializeU256",1),M([ze(0,Ae)],ae.prototype,"serializeU32AsUleb128",1);function On(n){if(typeof n!="boolean")throw new Error(`${n} is not a boolean value`)}var ei=(n,e,t)=>`${n} is out of range: [${e}, ${t}]`;function ve(n,e,t){let r=BigInt(n);if(r>BigInt(t)||r<BigInt(e))throw new Error(ei(n,e,t))}function ze(n,e){return(t,r,o)=>{let s=o.value;return o.value=function(a){return ve(a,n,e),s.apply(this,[a])},o}}var ni=(a=>(a.INCORRECT_NUMBER_OF_BYTES="incorrect_number_of_bytes",a.INVALID_HEX_CHARS="invalid_hex_chars",a.TOO_SHORT="too_short",a.TOO_LONG="too_long",a.LEADING_ZERO_X_REQUIRED="leading_zero_x_required",a.LONG_FORM_REQUIRED_UNLESS_SPECIAL="long_form_required_unless_special",a.INVALID_PADDING_ZEROES="INVALID_PADDING_ZEROES",a))(ni||{}),_=class _ extends d{constructor(e){if(super(),e.length!==_.LENGTH)throw new F("AccountAddress data should be exactly 32 bytes long","incorrect_number_of_bytes");this.data=e}isSpecial(){return this.data.slice(0,this.data.length-1).every(e=>e===0)&&this.data[this.data.length-1]<16}toString(){return`0x${this.toStringWithoutPrefix()}`}toStringWithoutPrefix(){let e=_utils.bytesToHex.call(void 0, this.data);return this.isSpecial()&&(e=e[e.length-1]),e}toStringLong(){return`0x${this.toStringLongWithoutPrefix()}`}toStringLongWithoutPrefix(){return _utils.bytesToHex.call(void 0, this.data)}toUint8Array(){return this.data}serialize(e){e.serializeFixedBytes(this.data)}serializeForEntryFunction(e){let t=this.bcsToBytes();e.serializeBytes(t)}serializeForScriptFunction(e){e.serializeU32AsUleb128(3),e.serialize(this)}static deserialize(e){let t=e.deserializeFixedBytes(_.LENGTH);return new _(t)}static fromStringStrict(e){if(!e.startsWith("0x"))throw new F("Hex string must start with a leading 0x.","leading_zero_x_required");let t=_.fromString(e);if(e.length!==_.LONG_STRING_LENGTH+2)if(t.isSpecial()){if(e.length!==3)throw new F(`The given hex string ${e} is a special address not in LONG form, it must be 0x0 to 0xf without padding zeroes.`,"INVALID_PADDING_ZEROES")}else throw new F(`The given hex string ${e} is not a special address, it must be represented as 0x + 64 chars.`,"long_form_required_unless_special");return t}static fromString(e){let t=e;if(e.startsWith("0x")&&(t=e.slice(2)),t.length===0)throw new F("Hex string is too short, must be 1 to 64 chars long, excluding the leading 0x.","too_short");if(t.length>64)throw new F("Hex string is too long, must be 1 to 64 chars long, excluding the leading 0x.","too_long");let r;try{r=_utils.hexToBytes.call(void 0, t.padStart(64,"0"))}catch(o){throw new F(`Hex characters are invalid: ${_optionalChain([o, 'optionalAccess', _18 => _18.message])}`,"invalid_hex_chars")}return new _(r)}static from(e){return e instanceof _?e:e instanceof Uint8Array?new _(e):_.fromString(e)}static fromStrict(e){return e instanceof _?e:e instanceof Uint8Array?new _(e):_.fromStringStrict(e)}static isValid(e){try{return e.strict?_.fromStrict(e.input):_.from(e.input),{valid:!0}}catch(t){return{valid:!1,invalidReason:_optionalChain([t, 'optionalAccess', _19 => _19.invalidReason]),invalidReasonMessage:_optionalChain([t, 'optionalAccess', _20 => _20.message])}}}equals(e){return this.data.length!==e.data.length?!1:this.data.every((t,r)=>t===e.data[r])}};_.LENGTH=32,_.LONG_STRING_LENGTH=64,_.ZERO=_.from("0x0"),_.ONE=_.from("0x1"),_.TWO=_.from("0x2"),_.THREE=_.from("0x3"),_.FOUR=_.from("0x4");var u=_;var Br=class{constructor(e){this.buffer=new ArrayBuffer(e.length),new Uint8Array(this.buffer).set(e,0),this.offset=0}read(e){if(this.offset+e>this.buffer.byteLength)throw new Error("Reached to the end of buffer");let t=this.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}deserializeStr(){let e=this.deserializeBytes();return new TextDecoder().decode(e)}deserializeBytes(){let e=this.deserializeUleb128AsU32();return new Uint8Array(this.read(e))}deserializeFixedBytes(e){return new Uint8Array(this.read(e))}deserializeBool(){let e=new Uint8Array(this.read(1))[0];if(e!==1&&e!==0)throw new Error("Invalid boolean value");return e===1}deserializeU8(){return new DataView(this.read(1)).getUint8(0)}deserializeU16(){return new DataView(this.read(2)).getUint16(0,!0)}deserializeU32(){return new DataView(this.read(4)).getUint32(0,!0)}deserializeU64(){let e=this.deserializeU32(),t=this.deserializeU32();return BigInt(BigInt(t)<<BigInt(32)|BigInt(e))}deserializeU128(){let e=this.deserializeU64(),t=this.deserializeU64();return BigInt(t<<BigInt(64)|e)}deserializeU256(){let e=this.deserializeU128(),t=this.deserializeU128();return BigInt(t<<BigInt(128)|e)}deserializeUleb128AsU32(){let e=BigInt(0),t=0;for(;e<Ae;){let r=this.deserializeU8();if(e|=BigInt(r&127)<<BigInt(t),!(r&128))break;t+=7}if(e>Ae)throw new Error("Overflow while parsing uleb128-encoded uint32 value");return Number(e)}deserialize(e){return e.deserialize(this)}deserializeVector(e){let t=this.deserializeUleb128AsU32(),r=new Array;for(let o=0;o<t;o+=1)r.push(this.deserialize(e));return r}};var Oe=class n extends d{constructor(e){super(),this.value=b.fromHexInput(e).toUint8Array()}serialize(e){e.serializeFixedBytes(this.value)}serializeForEntryFunction(e){e.serialize(this)}serializeForScriptFunction(e){e.serialize(this)}static deserialize(e,t){let r=e.deserializeFixedBytes(t);return new n(r)}};var jt=class n extends d{constructor(e){super(),this.value=new Oe(e)}serialize(e){e.serialize(this.value)}serializeForEntryFunction(e){e.serializeU32AsUleb128(this.value.value.length),e.serialize(this)}static deserialize(e,t){let r=Oe.deserialize(e,t);return new n(r.value)}};var I=class n extends d{constructor(e){super(),On(e),this.value=e}serialize(e){e.serializeBool(this.value)}serializeForEntryFunction(e){let t=this.bcsToBytes();e.serializeBytes(t)}serializeForScriptFunction(e){e.serializeU32AsUleb128(5),e.serialize(this)}static deserialize(e){return new n(e.deserializeBool())}},z= exports.U8 =class n extends d{constructor(e){super(),ve(e,0,Ht),this.value=e}serialize(e){e.serializeU8(this.value)}serializeForEntryFunction(e){let t=this.bcsToBytes();e.serializeBytes(t)}serializeForScriptFunction(e){e.serializeU32AsUleb128(0),e.serialize(this)}static deserialize(e){return new n(e.deserializeU8())}},te= exports.U16 =class n extends d{constructor(e){super(),ve(e,0,Qt),this.value=e}serialize(e){e.serializeU16(this.value)}serializeForEntryFunction(e){let t=this.bcsToBytes();e.serializeBytes(t)}serializeForScriptFunction(e){e.serializeU32AsUleb128(6),e.serialize(this)}static deserialize(e){return new n(e.deserializeU16())}},ne= exports.U32 =class n extends d{constructor(e){super(),ve(e,0,Ae),this.value=e}serialize(e){e.serializeU32(this.value)}serializeForEntryFunction(e){let t=this.bcsToBytes();e.serializeBytes(t)}serializeForScriptFunction(e){e.serializeU32AsUleb128(7),e.serialize(this)}static deserialize(e){return new n(e.deserializeU32())}},k= exports.U64 =class n extends d{constructor(e){super(),ve(e,BigInt(0),ke),this.value=BigInt(e)}serialize(e){e.serializeU64(this.value)}serializeForEntryFunction(e){let t=this.bcsToBytes();e.serializeBytes(t)}serializeForScriptFunction(e){e.serializeU32AsUleb128(1),e.serialize(this)}static deserialize(e){return new n(e.deserializeU64())}},re= exports.U128 =class n extends d{constructor(e){super(),ve(e,BigInt(0),bt),this.value=BigInt(e)}serialize(e){e.serializeU128(this.value)}serializeForEntryFunction(e){let t=this.bcsToBytes();e.serializeBytes(t)}serializeForScriptFunction(e){e.serializeU32AsUleb128(2),e.serialize(this)}static deserialize(e){return new n(e.deserializeU128())}},oe= exports.U256 =class n extends d{constructor(e){super(),ve(e,BigInt(0),Wt),this.value=BigInt(e)}serialize(e){e.serializeU256(this.value)}serializeForEntryFunction(e){let t=this.bcsToBytes();e.serializeBytes(t)}serializeForScriptFunction(e){e.serializeU32AsUleb128(8),e.serialize(this)}static deserialize(e){return new n(e.deserializeU256())}};var h=class n extends d{constructor(e){super(),this.values=e}serializeForEntryFunction(e){let t=this.bcsToBytes();e.serializeBytes(t)}serializeForScriptFunction(e){if(!(this.values[0]instanceof z)&&this.values[0]!==void 0)throw new Error("Script function arguments only accept u8 vectors");e.serializeU32AsUleb128(4),e.serialize(this)}static U8(e){let t;if(Array.isArray(e)&&typeof e[0]=="number")t=e;else if(typeof e=="string"){let r=b.fromHexInput(e);t=Array.from(r.toUint8Array())}else if(e instanceof Uint8Array)t=Array.from(e);else throw new Error("Invalid input type");return new n(t.map(r=>new z(r)))}static U16(e){return new n(e.map(t=>new te(t)))}static U32(e){return new n(e.map(t=>new ne(t)))}static U64(e){return new n(e.map(t=>new k(t)))}static U128(e){return new n(e.map(t=>new re(t)))}static U256(e){return new n(e.map(t=>new oe(t)))}static Bool(e){return new n(e.map(t=>new I(t)))}static MoveString(e){return new n(e.map(t=>new w(t)))}serialize(e){e.serializeVector(this.values)}static deserialize(e,t){let r=e.deserializeUleb128AsU32(),o=new Array;for(let s=0;s<r;s+=1)o.push(t.deserialize(e));return new n(o)}},w= exports.MoveString =class n extends d{constructor(e){super(),this.value=e}serialize(e){e.serializeStr(this.value)}serializeForEntryFunction(e){let t=this.bcsToBytes();e.serializeBytes(t)}serializeForScriptFunction(e){let t=this.bcsToBytes().slice(1);h.U8(t).serializeForScriptFunction(e)}static deserialize(e){return new n(e.deserializeStr())}},Ce= exports.MoveOption =class n extends d{constructor(e){super(),typeof e<"u"&&e!==null?this.vec=new h([e]):this.vec=new h([]),[this.value]=this.vec.values}serializeForEntryFunction(e){let t=this.bcsToBytes();e.serializeBytes(t)}unwrap(){if(this.isSome())return this.vec.values[0];throw new Error("Called unwrap on a MoveOption with no value")}isSome(){return this.vec.values.length===1}serialize(e){this.vec.serialize(e)}static U8(e){return new n(e!=null?new z(e):void 0)}static U16(e){return new n(e!=null?new te(e):void 0)}static U32(e){return new n(e!=null?new ne(e):void 0)}static U64(e){return new n(e!=null?new k(e):void 0)}static U128(e){return new n(e!=null?new re(e):void 0)}static U256(e){return new n(e!=null?new oe(e):void 0)}static Bool(e){return new n(e!=null?new I(e):void 0)}static MoveString(e){return new n(e!=null?new w(e):void 0)}static deserialize(e,t){let r=h.deserialize(e,t);return new n(r.values[0])}};var _tweetnacl = require('tweetnacl'); var _tweetnacl2 = _interopRequireDefault(_tweetnacl);var _sha3 = require('@noble/hashes/sha3');var Pe=class Pe extends d{constructor(e){super();let{data:t}=e,r=b.fromHexInput(t);if(r.toUint8Array().length!==Pe.LENGTH)throw new Error(`Authentication Key length should be ${Pe.LENGTH}`);this.data=r}serialize(e){e.serializeFixedBytes(this.data.toUint8Array())}static deserialize(e){let t=e.deserializeFixedBytes(Pe.LENGTH);return new Pe({data:t})}toString(){return this.data.toString()}toUint8Array(){return this.data.toUint8Array()}static fromSchemeAndBytes(e){let{scheme:t,input:r}=e,o=b.fromHexInput(r).toUint8Array(),s=new Uint8Array([...o,t]),i=_sha3.sha3_256.create();i.update(s);let a=i.digest();return new Pe({data:a})}static fromPublicKeyAndScheme(e){let{publicKey:t}=e;return t.authKey()}static fromPublicKey(e){let{publicKey:t}=e;return t.authKey()}derivedAddress(){return new u(this.data.toUint8Array())}};Pe.LENGTH=32;var K=Pe;var _hmac = require('@noble/hashes/hmac');var _sha512 = require('@noble/hashes/sha512');var _bip39 = require('@scure/bip39'); var Mr = _interopRequireWildcard(_bip39);var ii=/^m\/44'\/637'\/[0-9]+'\/[0-9]+'\/[0-9]+'?$/,ai= exports.APTOS_BIP44_REGEX =/^m\/44'\/637'\/[0-9]+'\/[0-9]+\/[0-9]+$/,ci= exports.KeyType =(e=>(e.ED25519="ed25519 seed",e))(ci||{}),Fr= exports.HARDENED_OFFSET =2147483648;function Kr(n){return ai.test(n)}function qr(n){return ii.test(n)}var Dn=(n,e)=>{let t=_hmac.hmac.create(_sha512.sha512,n).update(e).digest();return{key:t.slice(0,32),chainCode:t.slice(32)}},$r= exports.CKDPriv =({key:n,chainCode:e},t)=>{let r=new ArrayBuffer(4);new DataView(r).setUint32(0,t);let o=new Uint8Array(r),s=new Uint8Array([0]),i=new Uint8Array([...s,...n,...o]);return Dn(e,i)},ui=n=>n.replace("'",""),Lr= exports.splitPath =n=>n.split("/").slice(1).map(ui),Xt= exports.mnemonicToSeed =n=>{let e=n.trim().split(/\s+/).map(t=>t.toLowerCase()).join(" ");return Mr.mnemonicToSeedSync(e)};var wt=class extends d{toString(){let e=this.toUint8Array();return b.fromHexInput(e).toString()}},ce= exports.AccountPublicKey =class extends wt{};var X=class extends d{toString(){let e=this.toUint8Array();return b.fromHexInput(e).toString()}};var De=class De extends ce{constructor(e){super();let t=b.fromHexInput(e);if(t.toUint8Array().length!==De.LENGTH)throw new Error(`PublicKey length should be ${De.LENGTH}`);this.key=t}verifySignature(e){let{message:t,signature:r}=e;if(!(r instanceof R))return!1;let o=b.fromHexInput(t).toUint8Array(),s=r.toUint8Array(),i=this.key.toUint8Array();return _tweetnacl2.default.sign.detached.verify(o,s,i)}authKey(){return K.fromSchemeAndBytes({scheme:0,input:this.toUint8Array()})}toUint8Array(){return this.key.toUint8Array()}serialize(e){e.serializeBytes(this.key.toUint8Array())}static deserialize(e){let t=e.deserializeBytes();return new De(t)}static isPublicKey(e){return e instanceof De}};De.LENGTH=32;var U=De,D=class D extends d{constructor(e){super();let t=b.fromHexInput(e);if(t.toUint8Array().length!==D.LENGTH)throw new Error(`PrivateKey length should be ${D.LENGTH}`);this.signingKeyPair=_tweetnacl2.default.sign.keyPair.fromSeed(t.toUint8Array().slice(0,D.LENGTH))}static generate(){let e=_tweetnacl2.default.sign.keyPair();return new D(e.secretKey.slice(0,D.LENGTH))}static fromDerivationPath(e,t){if(!qr(e))throw new Error(`Invalid derivation path ${e}`);return D.fromDerivationPathInner(e,Xt(t))}static fromDerivationPathInner(e,t,r=Fr){let{key:o,chainCode:s}=Dn(D.SLIP_0010_SEED,t),i=Lr(e).map(c=>parseInt(c,10)),{key:a}=i.reduce((c,p)=>$r(c,p+r),{key:o,chainCode:s});return new D(a)}publicKey(){let e=this.signingKeyPair.publicKey;return new U(e)}sign(e){let t=b.fromHexInput(e).toUint8Array(),r=_tweetnacl2.default.sign.detached(t,this.signingKeyPair.secretKey);return new R(r)}toUint8Array(){return this.signingKeyPair.secretKey.slice(0,D.LENGTH)}toString(){return b.fromHexInput(this.toUint8Array()).toString()}serialize(e){e.serializeBytes(this.toUint8Array())}static deserialize(e){let t=e.deserializeBytes();return new D(t)}static isPrivateKey(e){return e instanceof D}};D.LENGTH=32,D.SLIP_0010_SEED="ed25519 seed";var Y=D,Qe=class Qe extends X{constructor(e){super();let t=b.fromHexInput(e);if(t.toUint8Array().length!==Qe.LENGTH)throw new Error(`Signature length should be ${Qe.LENGTH}`);this.data=t}toUint8Array(){return this.data.toUint8Array()}serialize(e){e.serializeBytes(this.data.toUint8Array())}static deserialize(e){let t=e.deserializeBytes();return new Qe(t)}};Qe.LENGTH=64;var R=Qe;var Z=class Z extends ce{constructor(e){super();let{publicKeys:t,threshold:r}=e;if(t.length>Z.MAX_KEYS||t.length<Z.MIN_KEYS)throw new Error(`Must have between ${Z.MIN_KEYS} and ${Z.MAX_KEYS} public keys, inclusive`);if(r<Z.MIN_THRESHOLD||r>t.length)throw new Error(`Threshold must be between ${Z.MIN_THRESHOLD} and ${t.length}, inclusive`);this.publicKeys=t,this.threshold=r}verifySignature(e){let{message:t,signature:r}=e;if(!(r instanceof Be))return!1;let o=[];for(let s=0;s<4;s+=1)for(let i=0;i<8;i+=1)if((r.bitmap[s]&1<<7-i)!==0){let c=s*8+i;o.push(c)}if(o.length!==r.signatures.length)throw new Error("Bitmap and signatures length mismatch");if(o.length<this.threshold)throw new Error("Not enough signatures");for(let s=0;s<o.length;s+=1)if(!this.publicKeys[o[s]].verifySignature({message:t,signature:r.signatures[s]}))return!1;return!0}authKey(){return K.fromSchemeAndBytes({scheme:1,input:this.toUint8Array()})}toUint8Array(){let e=new Uint8Array(this.publicKeys.length*U.LENGTH+1);return this.publicKeys.forEach((t,r)=>{e.set(t.toUint8Array(),r*U.LENGTH)}),e[this.publicKeys.length*U.LENGTH]=this.threshold,e}serialize(e){e.serializeBytes(this.toUint8Array())}static deserialize(e){let t=e.deserializeBytes(),r=t[t.length-1],o=[];for(let s=0;s<t.length-1;s+=U.LENGTH){let i=s;o.push(new U(t.subarray(i,i+U.LENGTH)))}return new Z({publicKeys:o,threshold:r})}};Z.MAX_KEYS=32,Z.MIN_KEYS=2,Z.MIN_THRESHOLD=1;var We=Z,L=class L extends X{constructor(e){super();let{signatures:t,bitmap:r}=e;if(t.length>L.MAX_SIGNATURES_SUPPORTED)throw new Error(`The number of signatures cannot be greater than ${L.MAX_SIGNATURES_SUPPORTED}`);if(this.signatures=t,!(r instanceof Uint8Array))this.bitmap=L.createBitmap({bits:r});else{if(r.length!==L.BITMAP_LEN)throw new Error(`"bitmap" length should be ${L.BITMAP_LEN}`);this.bitmap=r}}toUint8Array(){let e=new Uint8Array(this.signatures.length*R.LENGTH+L.BITMAP_LEN);return this.signatures.forEach((t,r)=>{e.set(t.toUint8Array(),r*R.LENGTH)}),e.set(this.bitmap,this.signatures.length*R.LENGTH),e}serialize(e){e.serializeBytes(this.toUint8Array())}static deserialize(e){let t=e.deserializeBytes(),r=t.subarray(t.length-4),o=[];for(let s=0;s<t.length-r.length;s+=R.LENGTH){let i=s;o.push(new R(t.subarray(i,i+R.LENGTH)))}return new L({signatures:o,bitmap:r})}static createBitmap(e){let{bits:t}=e,r=128,o=new Uint8Array([0,0,0,0]),s=new Set;return t.forEach((i,a)=>{if(i>=L.MAX_SIGNATURES_SUPPORTED)throw new Error(`Cannot have a signature larger than ${L.MAX_SIGNATURES_SUPPORTED-1}.`);if(s.has(i))throw new Error("Duplicate bits detected.");if(a>0&&i<=t[a-1])throw new Error("The bits need to be sorted in ascending order.");s.add(i);let c=Math.floor(i/8),p=o[c];p|=r>>i%8,o[c]=p}),o}};L.MAX_SIGNATURES_SUPPORTED=32,L.BITMAP_LEN=4;var Be=L;var _secp256k1 = require('@noble/curves/secp256k1');var _bip32 = require('@scure/bip32');var Me=class Me extends wt{constructor(e){super();let t=b.fromHexInput(e);if(t.toUint8Array().length!==Me.LENGTH)throw new Error(`PublicKey length should be ${Me.LENGTH}`);this.key=t}verifySignature(e){let{message:t,signature:r}=e;if(!(r instanceof he))return!1;let o=b.fromHexInput(t).toUint8Array(),s=_sha3.sha3_256.call(void 0, o),i=r.toUint8Array();return _secp256k1.secp256k1.verify(i,s,this.key.toUint8Array())}toUint8Array(){return this.key.toUint8Array()}serialize(e){e.serializeBytes(this.key.toUint8Array())}static deserialize(e){let t=e.deserializeBytes();return new Me(t)}static isPublicKey(e){return e instanceof Me}};Me.LENGTH=65;var fe=Me,ue=class ue extends d{constructor(e){super();let t=b.fromHexInput(e);if(t.toUint8Array().length!==ue.LENGTH)throw new Error(`PrivateKey length should be ${ue.LENGTH}`);this.key=t}static generate(){let e=_secp256k1.secp256k1.utils.randomPrivateKey();return new ue(e)}static fromDerivationPath(e,t){if(!Kr(e))throw new Error(`Invalid derivation path ${e}`);return ue.fromDerivationPathInner(e,Xt(t))}static fromDerivationPathInner(e,t){let{privateKey:r}=_bip32.HDKey.fromMasterSeed(t).derive(e);if(r===null)throw new Error("Invalid key");return new ue(r)}sign(e){let t=b.fromHexInput(e),r=_sha3.sha3_256.call(void 0, t.toUint8Array()),o=_secp256k1.secp256k1.sign(r,this.key.toUint8Array());return new he(o.toCompactRawBytes())}publicKey(){let e=_secp256k1.secp256k1.getPublicKey(this.key.toUint8Array(),!1);return new fe(e)}toUint8Array(){return this.key.toUint8Array()}toString(){return this.key.toString()}serialize(e){e.serializeBytes(this.toUint8Array())}static deserialize(e){let t=e.deserializeBytes();return new ue(t)}static isPrivateKey(e){return e instanceof ue}};ue.LENGTH=32;var Fe=ue,je=class je extends X{constructor(e){super();let t=b.fromHexInput(e);if(t.toUint8Array().length!==je.LENGTH)throw new Error(`Signature length should be ${je.LENGTH}, received ${t.toUint8Array().length}`);this.data=t}toUint8Array(){return this.data.toUint8Array()}serialize(e){e.serializeBytes(this.data.toUint8Array())}static deserialize(e){let t=e.deserializeBytes();return new je(t)}};je.LENGTH=64;var he=je;var q=class n extends ce{constructor(e){if(super(),this.publicKey=e,e instanceof U)this.variant=0;else if(e instanceof fe)this.variant=1;else throw new Error("Unsupported public key type")}verifySignature(e){let{message:t,signature:r}=e;return r instanceof B?this.publicKey.verifySignature({message:t,signature:r.signature}):!1}authKey(){return K.fromSchemeAndBytes({scheme:2,input:this.toUint8Array()})}toUint8Array(){return this.bcsToBytes()}serialize(e){e.serializeU32AsUleb128(this.variant),this.publicKey.serialize(e)}static deserialize(e){let t=e.deserializeUleb128AsU32(),r;switch(t){case 0:r=U.deserialize(e);break;case 1:r=fe.deserialize(e);break;default:throw new Error(`Unknown variant index for AnyPublicKey: ${t}`)}return new n(r)}static isPublicKey(e){return e instanceof n}isEd25519(){return this.publicKey instanceof U}isSecp256k1PublicKey(){return this.publicKey instanceof fe}},B= exports.AnySignature =class n extends X{constructor(e){if(super(),this.signature=e,e instanceof R)this.variant=0;else if(e instanceof he)this.variant=1;else throw new Error("Unsupported signature type")}toUint8Array(){return this.bcsToBytes()}serialize(e){e.serializeU32AsUleb128(this.variant),this.signature.serialize(e)}static deserialize(e){let t=e.deserializeUleb128AsU32(),r;switch(t){case 0:r=R.deserialize(e);break;case 1:r=he.deserialize(e);break;default:throw new Error(`Unknown variant index for AnySignature: ${t}`)}return new n(r)}};function Hr(n){let e=n;return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>24}var Jt=class n extends ce{constructor(e){super();let{publicKeys:t,signaturesRequired:r}=e;if(r<1)throw new Error("The number of required signatures needs to be greater than 0");if(t.length<r)throw new Error(`Provided ${t.length} public keys is smaller than the ${r} required signatures`);this.publicKeys=t.map(o=>o instanceof q?o:new q(o)),this.signaturesRequired=r}verifySignature(e){throw new Error("not implemented")}authKey(){return K.fromSchemeAndBytes({scheme:3,input:this.toUint8Array()})}toUint8Array(){return this.bcsToBytes()}serialize(e){e.serializeVector(this.publicKeys),e.serializeU8(this.signaturesRequired)}static deserialize(e){let t=e.deserializeVector(q),r=e.deserializeU8();return new n({publicKeys:t,signaturesRequired:r})}createBitmap(e){let{bits:t}=e,r=128,o=new Uint8Array([0,0,0,0]),s=new Set;return t.forEach((i,a)=>{if(a+1>this.publicKeys.length)throw new Error(`Signature index ${a+1} is out of public keys range, ${this.publicKeys.length}.`);if(s.has(i))throw new Error(`Duplicate bit ${i} detected.`);s.add(i);let c=Math.floor(i/8),p=o[c];p|=r>>i%8,o[c]=p}),o}},V=class V extends X{constructor(e){super();let{signatures:t,bitmap:r}=e;if(t.length>V.MAX_SIGNATURES_SUPPORTED)throw new Error(`The number of signatures cannot be greater than ${V.MAX_SIGNATURES_SUPPORTED}`);if(this.signatures=t.map(s=>s instanceof B?s:new B(s)),!(r instanceof Uint8Array))this.bitmap=V.createBitmap({bits:r});else{if(r.length!==V.BITMAP_LEN)throw new Error(`"bitmap" length should be ${V.BITMAP_LEN}`);this.bitmap=r}let o=this.bitmap.reduce((s,i)=>s+Hr(i),0);if(o!==this.signatures.length)throw new Error(`Expecting ${o} signatures from the bitmap, but got ${this.signatures.length}`)}static createBitmap(e){let{bits:t}=e,r=128,o=new Uint8Array([0,0,0,0]),s=new Set;return t.forEach(i=>{if(i>=V.MAX_SIGNATURES_SUPPORTED)throw new Error(`Cannot have a signature larger than ${V.MAX_SIGNATURES_SUPPORTED-1}.`);if(s.has(i))throw new Error("Duplicate bits detected.");s.add(i);let a=Math.floor(i/8),c=o[a];c|=r>>i%8,o[a]=c}),o}toUint8Array(){return this.bcsToBytes()}serialize(e){e.serializeVector(this.signatures),e.serializeBytes(this.bitmap)}static deserialize(e){let t=e.deserializeBytes(),r=t.reduce((s,i)=>s+Hr(i),0),o=[];for(let s=0;s<r;s+=1){let i=B.deserialize(e);o.push(i)}return new V({signatures:o,bitmap:t})}};V.BITMAP_LEN=4,V.MAX_SIGNATURES_SUPPORTED=V.BITMAP_LEN*8;var Qr=V;var H=class extends d{static deserialize(e){let t=e.deserializeUleb128AsU32();switch(t){case 0:return pe.load(e);case 1:return en.load(e);case 2:return se.load(e);case 3:return Xe.load(e);default:throw new Error(`Unknown variant index for AccountAuthenticator: ${t}`)}}isEd25519(){return this instanceof pe}isMultiEd25519(){return this instanceof en}isSingleKey(){return this instanceof se}isMultiKey(){return this instanceof Xe}},pe= exports.AccountAuthenticatorEd25519 =class n extends H{constructor(e,t){super(),this.public_key=e,this.signature=t}serialize(e){e.serializeU32AsUleb128(0),this.public_key.serialize(e),this.signature.serialize(e)}static load(e){let t=U.deserialize(e),r=R.deserialize(e);return new n(t,r)}},en= exports.AccountAuthenticatorMultiEd25519 =class n extends H{constructor(e,t){super(),this.public_key=e,this.signature=t}serialize(e){e.serializeU32AsUleb128(1),this.public_key.serialize(e),this.signature.serialize(e)}static load(e){let t=We.deserialize(e),r=Be.deserialize(e);return new n(t,r)}},se= exports.AccountAuthenticatorSingleKey =class n extends H{constructor(e,t){super(),this.public_key=e,this.signature=t}serialize(e){e.serializeU32AsUleb128(2),this.public_key.serialize(e),this.signature.serialize(e)}static load(e){let t=q.deserialize(e),r=B.deserialize(e);return new n(t,r)}},Xe= exports.AccountAuthenticatorMultiKey =class n extends H{constructor(e,t,r){super(),this.public_keys=e,this.signatures=t,this.signatures_bitmap=r}serialize(e){e.serializeU32AsUleb128(3),this.public_keys.serialize(e),e.serializeVector(this.signatures),e.serializeBytes(this.signatures_bitmap)}static load(e){let t=Jt.deserialize(e),r=e.deserializeVector(B),o=e.deserializeBytes();return new n(t,r,o)}};var Ye=class n{constructor(e){this.signingScheme=0;let{privateKey:t,address:r}=e;this.privateKey=t,this.publicKey=t.publicKey(),this.accountAddress=r?u.from(r):this.publicKey.authKey().derivedAddress()}static generate(){let e=Y.generate();return new n({privateKey:e})}static fromDerivationPath(e){let{path:t,mnemonic:r}=e,o=Y.fromDerivationPath(t,r);return new n({privateKey:o})}verifySignature(e){return this.publicKey.verifySignature(e)}signWithAuthenticator(e){let t=this.privateKey.sign(e);return new pe(this.publicKey,t)}sign(e){return this.signWithAuthenticator(e).signature}};var Ze=class n{constructor(e){this.signingScheme=2;let{privateKey:t,address:r}=e;this.privateKey=t,this.publicKey=new q(t.publicKey()),this.accountAddress=r?u.from(r):this.publicKey.authKey().derivedAddress()}static generate(e={}){let{scheme:t=0}=e,r;switch(t){case 0:r=Y.generate();break;case 2:r=Fe.generate();break;default:throw new Error(`Unsupported signature scheme ${t}`)}return new n({privateKey:r})}static fromDerivationPath(e){let{scheme:t=0,path:r,mnemonic:o}=e,s;switch(t){case 0:s=Y.fromDerivationPath(r,o);break;case 2:s=Fe.fromDerivationPath(r,o);break;default:throw new Error(`Unsupported signature scheme ${t}`)}return new n({privateKey:s})}verifySignature(e){return this.publicKey.verifySignature(e)}signWithAuthenticator(e){let t=this.privateKey.sign(e),r=new B(t);return new se(this.publicKey,r)}sign(e){return this.signWithAuthenticator(e).signature}};var Ee=class{static generate(e={}){let{scheme:t=0,legacy:r=!0}=e;return t===0&&r?Ye.generate():Ze.generate({scheme:t})}static fromPrivateKey(e){let{privateKey:t,address:r,legacy:o=!0}=e;return t instanceof Y&&o?new Ye({privateKey:t,address:r}):new Ze({privateKey:t,address:r})}static fromPrivateKeyAndAddress(e){return this.fromPrivateKey(e)}static fromDerivationPath(e){let{scheme:t=0,mnemonic:r,path:o,legacy:s=!0}=e;return t===0&&s?Ye.fromDerivationPath({mnemonic:r,path:o}):Ze.fromDerivationPath({scheme:t,mnemonic:r,path:o})}static authKey(e){let{publicKey:t}=e;return t.authKey()}verifySignature(e){return this.publicKey.verifySignature(e)}};var di=`
    fragment TokenActivitiesFields on token_activities_v2 {
  after_value
  before_value
  entry_function_id_str
  event_account_address
  event_index
  from_address
  is_fungible_v2
  property_version_v1
  to_address
  token_amount
  token_data_id
  token_standard
  transaction_timestamp
  transaction_version
  type
}
    `,li=`
    fragment AnsTokenFragment on current_aptos_names {
  domain
  expiration_timestamp
  registered_address
  subdomain
  token_standard
  is_primary
  owner_address
}
    `,tn=`
    fragment CurrentTokenOwnershipFields on current_token_ownerships_v2 {
  token_standard
  token_properties_mutated_v1
  token_data_id
  table_type_v1
  storage_id
  property_version_v1
  owner_address
  last_transaction_version
  last_transaction_timestamp
  is_soulbound_v2
  is_fungible_v2
  amount
  current_token_data {
    collection_id
    description
    is_fungible_v2
    largest_property_version_v1
    last_transaction_timestamp
    last_transaction_version
    maximum
    supply
    token_data_id
    token_name
    token_properties
    token_standard
    token_uri
    decimals
    current_collection {
      collection_id
      collection_name
      creator_address
      current_supply
      description
      last_transaction_timestamp
      last_transaction_version
      max_supply
      mutable_description
      mutable_uri
      table_handle_v1
      token_standard
      total_minted_v2
      uri
    }
  }
}
    `,Wr=`
    query getAccountCoinsCount($address: String) {
  current_fungible_asset_balances_aggregate(
    where: {owner_address: {_eq: $address}}
  ) {
    aggregate {
      count
    }
  }
}
    `,jr=`
    query getAccountCoinsData($where_condition: current_fungible_asset_balances_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_fungible_asset_balances_order_by!]) {
  current_fungible_asset_balances(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    amount
    asset_type
    is_frozen
    is_primary
    last_transaction_timestamp
    last_transaction_version
    owner_address
    storage_id
    token_standard
    metadata {
      token_standard
      symbol
      supply_aggregator_table_key_v1
      supply_aggregator_table_handle_v1
      project_uri
      name
      last_transaction_version
      last_transaction_timestamp
      icon_uri
      decimals
      creator_address
      asset_type
    }
  }
}
    `,Xr=`
    query getAccountCollectionsWithOwnedTokens($where_condition: current_collection_ownership_v2_view_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_collection_ownership_v2_view_order_by!]) {
  current_collection_ownership_v2_view(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    current_collection {
      collection_id
      collection_name
      creator_address
      current_supply
      description
      last_transaction_timestamp
      last_transaction_version
      mutable_description
      max_supply
      mutable_uri
      table_handle_v1
      token_standard
      total_minted_v2
      uri
    }
    collection_id
    collection_name
    collection_uri
    creator_address
    distinct_tokens
    last_transaction_version
    owner_address
    single_token_uri
  }
}
    `,Yr=`
    query getAccountOwnedObjects($where_condition: current_objects_bool_exp, $offset: Int, $limit: Int, $order_by: [current_objects_order_by!]) {
  current_objects(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    allow_ungated_transfer
    state_key_hash
    owner_address
    object_address
    last_transaction_version
    last_guid_creation_num
    is_deleted
  }
}
    `,Zr=`
    query getAccountOwnedTokens($where_condition: current_token_ownerships_v2_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_token_ownerships_v2_order_by!]) {
  current_token_ownerships_v2(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    ...CurrentTokenOwnershipFields
  }
}
    ${tn}`,Vp=`
    query getAccountOwnedTokensByTokenData($where_condition: current_token_ownerships_v2_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_token_ownerships_v2_order_by!]) {
  current_token_ownerships_v2(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    ...CurrentTokenOwnershipFields
  }
}
    ${tn}`,Jr=`
    query getAccountOwnedTokensFromCollection($where_condition: current_token_ownerships_v2_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_token_ownerships_v2_order_by!]) {
  current_token_ownerships_v2(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    ...CurrentTokenOwnershipFields
  }
}
    ${tn}`,eo=`
    query getAccountTokensCount($where_condition: current_token_ownerships_v2_bool_exp, $offset: Int, $limit: Int) {
  current_token_ownerships_v2_aggregate(
    where: $where_condition
    offset: $offset
    limit: $limit
  ) {
    aggregate {
      count
    }
  }
}
    `,to=`
    query getAccountTransactionsCount($address: String) {
  account_transactions_aggregate(where: {account_address: {_eq: $address}}) {
    aggregate {
      count
    }
  }
}
    `,no=`
    query getChainTopUserTransactions($limit: Int) {
  user_transactions(limit: $limit, order_by: {version: desc}) {
    version
  }
}
    `,Bn=`
    query getCollectionData($where_condition: current_collections_v2_bool_exp!) {
  current_collections_v2(where: $where_condition) {
    collection_id
    collection_name
    creator_address
    current_supply
    description
    last_transaction_timestamp
    last_transaction_version
    max_supply
    mutable_description
    mutable_uri
    table_handle_v1
    token_standard
    total_minted_v2
    uri
  }
}
    `,ro=`
    query getCurrentFungibleAssetBalances($where_condition: current_fungible_asset_balances_bool_exp, $offset: Int, $limit: Int) {
  current_fungible_asset_balances(
    where: $where_condition
    offset: $offset
    limit: $limit
  ) {
    amount
    asset_type
    is_frozen
    is_primary
    last_transaction_timestamp
    last_transaction_version
    owner_address
    storage_id
    token_standard
  }
}
    `,oo=`
    query getDelegatedStakingActivities($delegatorAddress: String, $poolAddress: String) {
  delegated_staking_activities(
    where: {delegator_address: {_eq: $delegatorAddress}, pool_address: {_eq: $poolAddress}}
  ) {
    amount
    delegator_address
    event_index
    event_type
    pool_address
    transaction_version
  }
}
    `,so=`
    query getEvents($where_condition: events_bool_exp, $offset: Int, $limit: Int, $order_by: [events_order_by!]) {
  events(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    account_address
    creation_number
    data
    event_index
    sequence_number
    transaction_block_height
    transaction_version
    type
    indexed_type
  }
}
    `,io=`
    query getFungibleAssetActivities($where_condition: fungible_asset_activities_bool_exp, $offset: Int, $limit: Int) {
  fungible_asset_activities(
    where: $where_condition
    offset: $offset
    limit: $limit
  ) {
    amount
    asset_type
    block_height
    entry_function_id_str
    event_index
    gas_fee_payer_address
    is_frozen
    is_gas_fee
    is_transaction_success
    owner_address
    storage_id
    storage_refund_amount
    token_standard
    transaction_timestamp
    transaction_version
    type
  }
}
    `,ao=`
    query getFungibleAssetMetadata($where_condition: fungible_asset_metadata_bool_exp, $offset: Int, $limit: Int) {
  fungible_asset_metadata(where: $where_condition, offset: $offset, limit: $limit) {
    icon_uri
    project_uri
    supply_aggregator_table_handle_v1
    supply_aggregator_table_key_v1
    creator_address
    asset_type
    decimals
    last_transaction_timestamp
    last_transaction_version
    name
    symbol
    token_standard
  }
}
    `,Je=`
    query getNames($offset: Int, $limit: Int, $where_condition: current_aptos_names_bool_exp, $order_by: [current_aptos_names_order_by!]) {
  current_aptos_names(
    limit: $limit
    where: $where_condition
    order_by: $order_by
    offset: $offset
  ) {
    ...AnsTokenFragment
  }
}
    ${li}`,Mn=`
    query getNumberOfDelegators($where_condition: num_active_delegator_per_pool_bool_exp, $order_by: [num_active_delegator_per_pool_order_by!]) {
  num_active_delegator_per_pool(where: $where_condition, order_by: $order_by) {
    num_active_delegator
    pool_address
  }
}
    `,Fn=`
    query getProcessorStatus($where_condition: processor_status_bool_exp) {
  processor_status(where: $where_condition) {
    last_success_version
    processor
    last_updated
  }
}
    `,co=`
    query getTokenActivity($where_condition: token_activities_v2_bool_exp!, $offset: Int, $limit: Int, $order_by: [token_activities_v2_order_by!]) {
  token_activities_v2(
    where: $where_condition
    order_by: $order_by
    offset: $offset
    limit: $limit
  ) {
    ...TokenActivitiesFields
  }
}
    ${di}`,Kn=`
    query getCurrentTokenOwnership($where_condition: current_token_ownerships_v2_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_token_ownerships_v2_order_by!]) {
  current_token_ownerships_v2(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    ...CurrentTokenOwnershipFields
  }
}
    ${tn}`,uo=`
    query getTokenData($where_condition: current_token_datas_v2_bool_exp, $offset: Int, $limit: Int, $order_by: [current_token_datas_v2_order_by!]) {
  current_token_datas_v2(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    collection_id
    description
    is_fungible_v2
    largest_property_version_v1
    last_transaction_timestamp
    last_transaction_version
    maximum
    supply
    token_data_id
    token_name
    token_properties
    token_standard
    token_uri
    decimals
    current_collection {
      collection_id
      collection_name
      creator_address
      current_supply
      description
      last_transaction_timestamp
      last_transaction_version
      max_supply
      mutable_description
      mutable_uri
      table_handle_v1
      token_standard
      total_minted_v2
      uri
    }
  }
}
    `;async function nn(n){let{aptosConfig:e}=n,{data:t}=await j({aptosConfig:e,originMethod:"getLedgerInfo",path:""});return t}async function po(n){let{aptosConfig:e,ledgerVersion:t,options:r}=n,{data:o}=await j({aptosConfig:e,originMethod:"getBlockByVersion",path:`blocks/by_version/${t}`,params:{with_transactions:_optionalChain([r, 'optionalAccess', _21 => _21.withTransactions])}});return o}async function lo(n){let{aptosConfig:e,blockHeight:t,options:r}=n,{data:o}=await j({aptosConfig:e,originMethod:"getBlockByHeight",path:`blocks/by_height/${t}`,params:{with_transactions:_optionalChain([r, 'optionalAccess', _22 => _22.withTransactions])}});return o}async function rn(n){let{aptosConfig:e,handle:t,data:r,options:o}=n;return(await He({aptosConfig:e,originMethod:"getTableItem",path:`tables/${t}/item`,params:{ledger_version:_optionalChain([o, 'optionalAccess', _23 => _23.ledgerVersion])},body:r})).data}async function Ie(n){let{aptosConfig:e,payload:t,options:r}=n,{data:o}=await He({aptosConfig:e,originMethod:"view",path:"view",params:{ledger_version:_optionalChain([r, 'optionalAccess', _24 => _24.ledgerVersion])},body:{function:t.function,type_arguments:_nullishCoalesce(t.typeArguments, () => ([])),arguments:_nullishCoalesce(t.functionArguments, () => ([]))}});return o}async function go(n){let{aptosConfig:e,limit:t}=n;return(await m({aptosConfig:e,query:{query:no,variables:{limit:t}},originMethod:"getChainTopUserTransactions"})).user_transactions}async function m(n){let{aptosConfig:e,query:t,originMethod:r}=n,{data:o}=await zr({aptosConfig:e,originMethod:_nullishCoalesce(r, () => ("queryIndexer")),path:"",body:t,overrides:{WITH_CREDENTIALS:!1}});return o}async function gi(n){let{aptosConfig:e}=n;return(await m({aptosConfig:e,query:{query:Fn},originMethod:"getProcessorStatuses"})).processor_status}async function on(n){let e=await gi({aptosConfig:n.aptosConfig});return BigInt(e[0].last_success_version)}async function sn(n){let{aptosConfig:e,processorType:t}=n,r={processor:{_eq:t.valueOf()}};return(await m({aptosConfig:e,query:{query:Fn,variables:{where_condition:r}},originMethod:"getProcessorStatus"})).processor_status[0]}var qn=new Map;function et(n,e,t){return async(...r)=>{if(qn.has(e)){let{value:s,timestamp:i}=qn.get(e);if(t===void 0||Date.now()-i<=t)return s}let o=await n(...r);return qn.set(e,{value:o,timestamp:Date.now()}),o}}async function de(n){let{aptosConfig:e,accountAddress:t}=n,{data:r}=await j({aptosConfig:e,originMethod:"getInfo",path:`accounts/${u.from(t).toString()}`});return r}async function Ao(n){let{aptosConfig:e,accountAddress:t,options:r}=n;return Ve({aptosConfig:e,originMethod:"getModules",path:`accounts/${u.from(t).toString()}/modules`,params:{ledger_version:_optionalChain([r, 'optionalAccess', _25 => _25.ledgerVersion]),start:_optionalChain([r, 'optionalAccess', _26 => _26.offset]),limit:_nullishCoalesce(_optionalChain([r, 'optionalAccess', _27 => _27.limit]), () => (1e3))}})}async function an(n){return _optionalChain([n, 'access', _28 => _28.options, 'optionalAccess', _29 => _29.ledgerVersion])!==void 0?mo(n):et(async()=>mo(n),`module-${n.accountAddress}-${n.moduleName}`,1e3*60*5)()}async function mo(n){let{aptosConfig:e,accountAddress:t,moduleName:r,options:o}=n,{data:s}=await j({aptosConfig:e,originMethod:"getModule",path:`accounts/${u.from(t).toString()}/module/${r}`,params:{ledger_version:_optionalChain([o, 'optionalAccess', _30 => _30.ledgerVersion])}});return s}async function fo(n){let{aptosConfig:e,accountAddress:t,options:r}=n;return Ve({aptosConfig:e,originMethod:"getTransactions",path:`accounts/${u.from(t).toString()}/transactions`,params:{start:_optionalChain([r, 'optionalAccess', _31 => _31.offset]),limit:_optionalChain([r, 'optionalAccess', _32 => _32.limit])}})}async function ho(n){let{aptosConfig:e,accountAddress:t,options:r}=n;return Ve({aptosConfig:e,originMethod:"getResources",path:`accounts/${u.from(t).toString()}/resources`,params:{ledger_version:_optionalChain([r, 'optionalAccess', _33 => _33.ledgerVersion]),start:_optionalChain([r, 'optionalAccess', _34 => _34.offset]),limit:_nullishCoalesce(_optionalChain([r, 'optionalAccess', _35 => _35.limit]), () => (999))}})}async function $n(n){let{aptosConfig:e,accountAddress:t,resourceType:r,options:o}=n,{data:s}=await j({aptosConfig:e,originMethod:"getResource",path:`accounts/${u.from(t).toString()}/resource/${r}`,params:{ledger_version:_optionalChain([o, 'optionalAccess', _36 => _36.ledgerVersion])}});return s.data}async function Ln(n){let{aptosConfig:e,authenticationKey:t,options:r}=n,o=await $n({aptosConfig:e,accountAddress:"0x1",resourceType:"0x1::account::OriginatingAddress",options:r}),{address_map:{handle:s}}=o,i=u.from(t);try{let a=await rn({aptosConfig:e,handle:s,data:{key:i.toString(),key_type:"address",value_type:"address"},options:r});return u.from(a)}catch(a){if(a instanceof ye&&a.data.error_code==="table_item_not_found")return i;throw a}}async function To(n){let{aptosConfig:e,accountAddress:t}=n,o={owner_address:{_eq:u.from(t).toStringLong()},amount:{_gt:0}},i=await m({aptosConfig:e,query:{query:eo,variables:{where_condition:o}},originMethod:"getAccountTokensCount"});return i.current_token_ownerships_v2_aggregate.aggregate?i.current_token_ownerships_v2_aggregate.aggregate.count:0}async function bo(n){let{aptosConfig:e,accountAddress:t,options:r}=n,s={owner_address:{_eq:u.from(t).toStringLong()},amount:{_gt:0}};_optionalChain([r, 'optionalAccess', _37 => _37.tokenStandard])&&(s.token_standard={_eq:_optionalChain([r, 'optionalAccess', _38 => _38.tokenStandard])});let i={query:Zr,variables:{where_condition:s,offset:_optionalChain([r, 'optionalAccess', _39 => _39.offset]),limit:_optionalChain([r, 'optionalAccess', _40 => _40.limit]),order_by:_optionalChain([r, 'optionalAccess', _41 => _41.orderBy])}};return(await m({aptosConfig:e,query:i,originMethod:"getAccountOwnedTokens"})).current_token_ownerships_v2}async function wo(n){let{aptosConfig:e,accountAddress:t,collectionAddress:r,options:o}=n,s=u.from(t).toStringLong(),i=u.from(r).toStringLong(),a={owner_address:{_eq:s},current_token_data:{collection_id:{_eq:i}},amount:{_gt:0}};_optionalChain([o, 'optionalAccess', _42 => _42.tokenStandard])&&(a.token_standard={_eq:_optionalChain([o, 'optionalAccess', _43 => _43.tokenStandard])});let c={query:Jr,variables:{where_condition:a,offset:_optionalChain([o, 'optionalAccess', _44 => _44.offset]),limit:_optionalChain([o, 'optionalAccess', _45 => _45.limit]),order_by:_optionalChain([o, 'optionalAccess', _46 => _46.orderBy])}};return(await m({aptosConfig:e,query:c,originMethod:"getAccountOwnedTokensFromCollectionAddress"})).current_token_ownerships_v2}async function _o(n){let{aptosConfig:e,accountAddress:t,options:r}=n,s={owner_address:{_eq:u.from(t).toStringLong()},amount:{_gt:0}};_optionalChain([r, 'optionalAccess', _47 => _47.tokenStandard])&&(s.current_collection={token_standard:{_eq:_optionalChain([r, 'optionalAccess', _48 => _48.tokenStandard])}});let i={query:Xr,variables:{where_condition:s,offset:_optionalChain([r, 'optionalAccess', _49 => _49.offset]),limit:_optionalChain([r, 'optionalAccess', _50 => _50.limit]),order_by:_optionalChain([r, 'optionalAccess', _51 => _51.orderBy])}};return(await m({aptosConfig:e,query:i,originMethod:"getAccountCollectionsWithOwnedTokens"})).current_collection_ownership_v2_view}async function So(n){let{aptosConfig:e,accountAddress:t}=n,r=u.from(t).toStringLong(),s=await m({aptosConfig:e,query:{query:to,variables:{address:r}},originMethod:"getAccountTransactionsCount"});return s.account_transactions_aggregate.aggregate?s.account_transactions_aggregate.aggregate.count:0}async function xo(n){let{aptosConfig:e,accountAddress:t,coinType:r}=n,o=u.from(t).toStringLong(),s=await Vn({aptosConfig:e,accountAddress:o,options:{where:{asset_type:{_eq:r}}}});return s[0]?s[0].amount:0}async function Vn(n){let{aptosConfig:e,accountAddress:t,options:r}=n,o=u.from(t).toStringLong(),s={..._optionalChain([r, 'optionalAccess', _52 => _52.where]),owner_address:{_eq:o}},i={query:jr,variables:{where_condition:s,offset:_optionalChain([r, 'optionalAccess', _53 => _53.offset]),limit:_optionalChain([r, 'optionalAccess', _54 => _54.limit]),order_by:_optionalChain([r, 'optionalAccess', _55 => _55.orderBy])}};return(await m({aptosConfig:e,query:i,originMethod:"getAccountCoinsData"})).current_fungible_asset_balances}async function vo(n){let{aptosConfig:e,accountAddress:t}=n,r=u.from(t).toStringLong(),s=await m({aptosConfig:e,query:{query:Wr,variables:{address:r}},originMethod:"getAccountCoinsCount"});if(!s.current_fungible_asset_balances_aggregate.aggregate)throw Error("Failed to get the count of account coins");return s.current_fungible_asset_balances_aggregate.aggregate.count}async function Co(n){let{aptosConfig:e,accountAddress:t,options:r}=n,s={owner_address:{_eq:u.from(t).toStringLong()}},i={query:Yr,variables:{where_condition:s,offset:_optionalChain([r, 'optionalAccess', _56 => _56.offset]),limit:_optionalChain([r, 'optionalAccess', _57 => _57.limit]),order_by:_optionalChain([r, 'optionalAccess', _58 => _58.orderBy])}};return(await m({aptosConfig:e,query:i,originMethod:"getAccountOwnedObjects"})).current_objects}async function Po(n){let{aptosConfig:e,privateKey:t}=n,r=new q(t.publicKey());if(t instanceof Fe){let s=K.fromPublicKeyAndScheme({publicKey:r,scheme:2}).derivedAddress();return Ee.fromPrivateKeyAndAddress({privateKey:t,address:s})}if(t instanceof Y){let o=K.fromPublicKeyAndScheme({publicKey:r,scheme:2});if(await yo({authKey:o,aptosConfig:e})){let c=o.derivedAddress();return Ee.fromPrivateKeyAndAddress({privateKey:t,address:c,legacy:!1})}let i=K.fromPublicKeyAndScheme({publicKey:r.publicKey,scheme:0});if(await yo({authKey:i,aptosConfig:e})){let c=i.derivedAddress();return Ee.fromPrivateKeyAndAddress({privateKey:t,address:c,legacy:!0})}}throw new Error(`Can't derive account from private key ${t}`)}async function yo(n){let{aptosConfig:e,authKey:t}=n,r=await Ln({aptosConfig:e,authenticationKey:t.derivedAddress()});try{return await de({aptosConfig:e,accountAddress:r}),!0}catch(o){if(o.status===404)return!1;throw new Error(`Error while looking for an account info ${r.toString()}`)}}async function Ue(n){return new Promise(e=>{setTimeout(e,n)})}async function Eo(n){let{aptosConfig:e,options:t}=n;return Ve({aptosConfig:e,originMethod:"getTransactions",path:"transactions",params:{start:_optionalChain([t, 'optionalAccess', _59 => _59.offset]),limit:_optionalChain([t, 'optionalAccess', _60 => _60.limit])}})}async function un(n){let{aptosConfig:e}=n;return et(async()=>{let{data:t}=await j({aptosConfig:e,originMethod:"getGasPriceEstimation",path:"estimate_gas_price"});return t},`gas-price-${e.network}`,1e3*60*5)()}async function Io(n){let{aptosConfig:e,ledgerVersion:t}=n,{data:r}=await j({aptosConfig:e,originMethod:"getTransactionByVersion",path:`transactions/by_version/${t}`});return r}async function pn(n){let{aptosConfig:e,transactionHash:t}=n,{data:r}=await j({aptosConfig:e,path:`transactions/by_hash/${t}`,originMethod:"getTransactionByHash"});return r}async function Uo(n){let{aptosConfig:e,transactionHash:t}=n;try{return(await pn({aptosConfig:e,transactionHash:t})).type==="pending_transaction"}catch(r){if(_optionalChain([r, 'optionalAccess', _61 => _61.status])===404)return!0;throw r}}async function tt(n){let{aptosConfig:e,transactionHash:t,options:r}=n,o=_nullishCoalesce(_optionalChain([r, 'optionalAccess', _62 => _62.timeoutSecs]), () => (20)),s=_nullishCoalesce(_optionalChain([r, 'optionalAccess', _63 => _63.checkSuccess]), () => (!0)),i=!0,a=0,c,p,f=200,C=1.5;for(;i&&!(a>=o);){try{if(c=await pn({aptosConfig:e,transactionHash:t}),i=c.type==="pending_transaction",!i)break}catch(y){if(!(y instanceof ye)||(p=y,y.status!==404&&y.status>=400&&y.status<500))throw y}await Ue(f),a+=f/1e3,f*=C}if(c===void 0)throw p||new cn(`Fetching transaction ${t} failed and timed out after ${o} seconds`,c);if(c.type==="pending_transaction")throw new cn(`Transaction ${t} timed out in pending state after ${o} seconds`,c);if(!s)return c;if(!c.success)throw new Hn(`Transaction ${t} failed with an error: ${c.vm_status}`,c);return c}async function dn(n){let{aptosConfig:e,processorType:t}=n,r=BigInt(n.minimumLedgerVersion),o=3e3,s=new Date().getTime(),i=BigInt(-1);for(;i<r;){if(new Date().getTime()-s>o)throw new Error("waitForLastSuccessIndexerVersionSync timeout");if(t===void 0?i=await on({aptosConfig:e}):i=(await sn({aptosConfig:e,processorType:t})).last_success_version,i>=r)break;await Ue(200)}}var cn=class extends Error{constructor(e,t){super(e),this.lastSubmittedTransaction=t}},Hn=class extends Error{constructor(e,t){super(e),this.transaction=t}};async function T(n){n.minimumLedgerVersion!==void 0&&await dn({aptosConfig:n.config,minimumLedgerVersion:n.minimumLedgerVersion,processorType:n.processorType})}var _t=class{constructor(e){this.config=e}async getAccountInfo(e){return de({aptosConfig:this.config,...e})}async getAccountModules(e){return Ao({aptosConfig:this.config,...e})}async getAccountModule(e){return an({aptosConfig:this.config,...e})}async getAccountTransactions(e){return fo({aptosConfig:this.config,...e})}async getAccountResources(e){return ho({aptosConfig:this.config,...e})}async getAccountResource(e){return $n({aptosConfig:this.config,...e})}async lookupOriginalAccountAddress(e){return Ln({aptosConfig:this.config,...e})}async getAccountTokensCount(e){return await T({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"account_transactions_processor"}),To({aptosConfig:this.config,...e})}async getAccountOwnedTokens(e){return await T({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"token_v2_processor"}),bo({aptosConfig:this.config,...e})}async getAccountOwnedTokensFromCollectionAddress(e){return await T({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"token_v2_processor"}),wo({aptosConfig:this.config,...e})}async getAccountCollectionsWithOwnedTokens(e){return await T({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"token_v2_processor"}),_o({aptosConfig:this.config,...e})}async getAccountTransactionsCount(e){return await T({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"account_transactions_processor"}),So({aptosConfig:this.config,...e})}async getAccountCoinsData(e){return await T({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"fungible_asset_processor"}),Vn({aptosConfig:this.config,...e})}async getAccountCoinsCount(e){return await T({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"fungible_asset_processor"}),vo({aptosConfig:this.config,...e})}async getAccountAPTAmount(e){return this.getAccountCoinAmount({coinType:Vt,...e})}async getAccountCoinAmount(e){return await T({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"fungible_asset_processor"}),xo({aptosConfig:this.config,...e})}async getAccountOwnedObjects(e){return await T({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"default_processor"}),Co({aptosConfig:this.config,...e})}async deriveAccountFromPrivateKey(e){return Po({aptosConfig:this.config,...e})}};var _aptosclient = require('@aptos-labs/aptos-client'); var _aptosclient2 = _interopRequireDefault(_aptosclient);var Qn={mainnet:"https://indexer.mainnet.aptoslabs.com/v1/graphql",testnet:"https://indexer-testnet.staging.gcp.aptosdev.com/v1/graphql",devnet:"https://indexer-devnet.staging.gcp.aptosdev.com/v1/graphql",randomnet:"https://indexer-randomnet.hasura.app/v1/graphql",local:"http://127.0.0.1:8090/v1/graphql"},Wn= exports.NetworkToNodeAPI ={mainnet:"https://api.mainnet.aptoslabs.com/v1",testnet:"https://api.testnet.aptoslabs.com/v1",devnet:"https://api.devnet.aptoslabs.com/v1",randomnet:"https://fullnode.random.aptoslabs.com/v1",local:"http://127.0.0.1:8080/v1"},jn= exports.NetworkToFaucetAPI ={mainnet:"https://faucet.mainnet.aptoslabs.com",testnet:"https://faucet.testnet.aptoslabs.com",devnet:"https://faucet.devnet.aptoslabs.com",randomnet:"https://faucet.random.aptoslabs.com",local:"http://127.0.0.1:8081"},Xn= exports.Network =(i=>(i.MAINNET="mainnet",i.TESTNET="testnet",i.DEVNET="devnet",i.RANDOMNET="randomnet",i.LOCAL="local",i.CUSTOM="custom",i))(Xn||{}),Yn= exports.NetworkToChainId ={mainnet:1,testnet:2,randomnet:70},jd= exports.NetworkToNetworkName ={mainnet:"mainnet",testnet:"testnet",devnet:"devnet",randomnet:"randomnet",local:"local",custom:"custom"};var ln=class{constructor(e){this.network=_nullishCoalesce(_optionalChain([e, 'optionalAccess', _64 => _64.network]), () => ("devnet")),this.fullnode=_optionalChain([e, 'optionalAccess', _65 => _65.fullnode]),this.faucet=_optionalChain([e, 'optionalAccess', _66 => _66.faucet]),this.indexer=_optionalChain([e, 'optionalAccess', _67 => _67.indexer]),this.client=_nullishCoalesce(_optionalChain([e, 'optionalAccess', _68 => _68.client]), () => ({provider:_aptosclient2.default})),this.clientConfig=_nullishCoalesce(_optionalChain([e, 'optionalAccess', _69 => _69.clientConfig]), () => ({}))}getRequestUrl(e){switch(e){case 0:if(this.fullnode!==void 0)return this.fullnode;if(this.network==="custom")throw new Error("Please provide a custom full node url");return Wn[this.network];case 2:if(this.faucet!==void 0)return this.faucet;if(this.network==="custom")throw new Error("Please provide a custom faucet url");return jn[this.network];case 1:if(this.indexer!==void 0)return this.indexer;if(this.network==="custom")throw new Error("Please provide a custom indexer url");return Qn[this.network];default:throw Error(`apiType ${e} is not supported`)}}isIndexerRequest(e){return Qn[this.network]===e}isFullnodeRequest(e){return Wn[this.network]===e}isFaucetRequest(e){return jn[this.network]===e}};var gn=class extends d{constructor(t){super();this.accountAddress=u.ONE;this.moduleName=new w("account");this.structName=new w("RotationProofChallenge");this.sequenceNumber=new k(t.sequenceNumber),this.originator=t.originator,this.currentAuthKey=t.currentAuthKey,this.newPublicKey=h.U8(t.newPublicKey.toUint8Array())}serialize(t){t.serialize(this.accountAddress),t.serialize(this.moduleName),t.serialize(this.structName),t.serialize(this.sequenceNumber),t.serialize(this.originator),t.serialize(this.currentAuthKey),t.serialize(this.newPublicKey)}};var Te=class extends d{static deserialize(e){let t=e.deserializeUleb128AsU32();switch(t){case 0:return nt.load(e);case 1:return Zn.load(e);case 2:return rt.load(e);case 3:return ot.load(e);case 4:return st.load(e);default:throw new Error(`Unknown variant index for TransactionAuthenticator: ${t}`)}}},nt= exports.TransactionAuthenticatorEd25519 =class n extends Te{constructor(e,t){super(),this.public_key=e,this.signature=t}serialize(e){e.serializeU32AsUleb128(0),this.public_key.serialize(e),this.signature.serialize(e)}static load(e){let t=U.deserialize(e),r=R.deserialize(e);return new n(t,r)}},Zn= exports.TransactionAuthenticatorMultiEd25519 =class n extends Te{constructor(e,t){super(),this.public_key=e,this.signature=t}serialize(e){e.serializeU32AsUleb128(1),this.public_key.serialize(e),this.signature.serialize(e)}static load(e){let t=We.deserialize(e),r=Be.deserialize(e);return new n(t,r)}},rt= exports.TransactionAuthenticatorMultiAgent =class n extends Te{constructor(e,t,r){super(),this.sender=e,this.secondary_signer_addresses=t,this.secondary_signers=r}serialize(e){e.serializeU32AsUleb128(2),this.sender.serialize(e),e.serializeVector(this.secondary_signer_addresses),e.serializeVector(this.secondary_signers)}static load(e){let t=H.deserialize(e),r=e.deserializeVector(u),o=e.deserializeVector(H);return new n(t,r,o)}},ot= exports.TransactionAuthenticatorFeePayer =class n extends Te{constructor(e,t,r,o){super(),this.sender=e,this.secondary_signer_addresses=t,this.secondary_signers=r,this.fee_payer=o}serialize(e){e.serializeU32AsUleb128(3),this.sender.serialize(e),e.serializeVector(this.secondary_signer_addresses),e.serializeVector(this.secondary_signers),this.fee_payer.address.serialize(e),this.fee_payer.authenticator.serialize(e)}static load(e){let t=H.deserialize(e),r=e.deserializeVector(u),o=e.deserializeVector(H),s=u.deserialize(e),i=H.deserialize(e),a={address:s,authenticator:i};return new n(t,r,o,a)}},st= exports.TransactionAuthenticatorSingleSender =class n extends Te{constructor(e){super(),this.sender=e}serialize(e){e.serializeU32AsUleb128(4),this.sender.serialize(e)}static load(e){let t=H.deserialize(e);return new n(t)}};var it=class n extends d{constructor(e){super(),this.chainId=e}serialize(e){e.serializeU8(this.chainId)}static deserialize(e){let t=e.deserializeU8();return new n(t)}};var E=class n extends d{constructor(e){super(),this.identifier=e}serialize(e){e.serializeStr(this.identifier)}static deserialize(e){let t=e.deserializeStr();return new n(t)}};var St=class n extends d{constructor(e,t){super(),this.address=e,this.name=t}static fromStr(e){let t=e.split("::");if(t.length!==2)throw new Error("Invalid module id.");return new n(u.fromString(t[0]),new E(t[1]))}serialize(e){this.address.serialize(e),this.name.serialize(e)}static deserialize(e){let t=u.deserialize(e),r=E.deserialize(e);return new n(t,r)}};var N=class extends d{static deserialize(e){let t=e.deserializeUleb128AsU32();switch(t){case 0:return O.load(e);case 1:return le.load(e);case 2:return $.load(e);case 3:return ut.load(e);case 4:return Q.load(e);case 5:return Ke.load(e);case 6:return x.load(e);case 7:return l.load(e);case 8:return at.load(e);case 9:return ct.load(e);case 10:return pt.load(e);case 255:return G.load(e);default:throw new Error(`Unknown variant index for TypeTag: ${t}`)}}isBool(){return this instanceof O}isAddress(){return this instanceof Q}isGeneric(){return this instanceof G}isSigner(){return this instanceof Ke}isVector(){return this instanceof x}isStruct(){return this instanceof l}isU8(){return this instanceof le}isU16(){return this instanceof at}isU32(){return this instanceof ct}isU64(){return this instanceof $}isU128(){return this instanceof ut}isU256(){return this instanceof pt}},O= exports.TypeTagBool =class n extends N{toString(){return"bool"}serialize(e){e.serializeU32AsUleb128(0)}static load(e){return new n}},le= exports.TypeTagU8 =class n extends N{toString(){return"u8"}serialize(e){e.serializeU32AsUleb128(1)}static load(e){return new n}},at= exports.TypeTagU16 =class n extends N{toString(){return"u16"}serialize(e){e.serializeU32AsUleb128(8)}static load(e){return new n}},ct= exports.TypeTagU32 =class n extends N{toString(){return"u32"}serialize(e){e.serializeU32AsUleb128(9)}static load(e){return new n}},$= exports.TypeTagU64 =class n extends N{toString(){return"u64"}serialize(e){e.serializeU32AsUleb128(2)}static load(e){return new n}},ut= exports.TypeTagU128 =class n extends N{toString(){return"u128"}serialize(e){e.serializeU32AsUleb128(3)}static load(e){return new n}},pt= exports.TypeTagU256 =class n extends N{toString(){return"u256"}serialize(e){e.serializeU32AsUleb128(10)}static load(e){return new n}},Q= exports.TypeTagAddress =class n extends N{toString(){return"address"}serialize(e){e.serializeU32AsUleb128(4)}static load(e){return new n}},Ke= exports.TypeTagSigner =class n extends N{toString(){return"signer"}serialize(e){e.serializeU32AsUleb128(5)}static load(e){return new n}},mn= exports.TypeTagReference =class n extends N{constructor(t){super();this.value=t}toString(){return`&${this.value.toString()}`}serialize(t){t.serializeU32AsUleb128(254)}static load(t){let r=N.deserialize(t);return new n(r)}},G= exports.TypeTagGeneric =class n extends N{constructor(t){super();this.value=t;if(t<0)throw new Error("Generic type parameter index cannot be negative")}toString(){return`T${this.value}`}serialize(t){t.serializeU32AsUleb128(255),t.serializeU32(this.value)}static load(t){let r=t.deserializeU32();return new n(r)}},x= exports.TypeTagVector =class n extends N{constructor(t){super();this.value=t}toString(){return`vector<${this.value.toString()}>`}static u8(){return new n(new le)}serialize(t){t.serializeU32AsUleb128(6),this.value.serialize(t)}static load(t){let r=N.deserialize(t);return new n(r)}},l= exports.TypeTagStruct =class n extends N{constructor(t){super();this.value=t}toString(){let t="";return this.value.typeArgs.length>0&&(t=`<${this.value.typeArgs.map(r=>r.toString()).join(", ")}>`),`${this.value.address.toString()}::${this.value.moduleName.identifier}::${this.value.name.identifier}${t}`}serialize(t){t.serializeU32AsUleb128(7),this.value.serialize(t)}static load(t){let r=be.deserialize(t);return new n(r)}isTypeTag(t,r,o){return this.value.moduleName.identifier===r&&this.value.name.identifier===o&&this.value.address.equals(t)}isString(){return this.isTypeTag(u.ONE,"string","String")}isOption(){return this.isTypeTag(u.ONE,"option","Option")}isObject(){return this.isTypeTag(u.ONE,"object","Object")}},be= exports.StructTag =class n extends d{constructor(e,t,r,o){super(),this.address=e,this.moduleName=t,this.name=r,this.typeArgs=o}serialize(e){e.serialize(this.address),e.serialize(this.moduleName),e.serialize(this.name),e.serializeVector(this.typeArgs)}static deserialize(e){let t=u.deserialize(e),r=E.deserialize(e),o=E.deserialize(e),s=e.deserializeVector(N);return new n(t,r,o,s)}};function Nl(){return new be(u.ONE,new E("aptos_coin"),new E("AptosCoin"),[])}function S(){return new be(u.ONE,new E("string"),new E("String"),[])}function Gl(n){return new be(u.ONE,new E("option"),new E("Option"),[n])}function W(n){return new be(u.ONE,new E("object"),new E("Object"),[n])}function yi(n){let e=n.deserializeUleb128AsU32();switch(e){case 0:return z.deserialize(n);case 1:return k.deserialize(n);case 2:return re.deserialize(n);case 3:return u.deserialize(n);case 4:return h.deserialize(n,z);case 5:return I.deserialize(n);case 6:return te.deserialize(n);case 7:return ne.deserialize(n);case 8:return oe.deserialize(n);default:throw new Error(`Unknown variant index for ScriptTransactionArgument: ${e}`)}}var qe=class extends d{static deserialize(e){let t=e.deserializeUleb128AsU32();switch(t){case 0:return xt.load(e);case 2:return vt.load(e);case 3:return Ct.load(e);default:throw new Error(`Unknown variant index for TransactionPayload: ${t}`)}}},xt= exports.TransactionPayloadScript =class n extends qe{constructor(e){super(),this.script=e}serialize(e){e.serializeU32AsUleb128(0),this.script.serialize(e)}static load(e){let t=Pt.deserialize(e);return new n(t)}},vt= exports.TransactionPayloadEntryFunction =class n extends qe{constructor(e){super(),this.entryFunction=e}serialize(e){e.serializeU32AsUleb128(2),this.entryFunction.serialize(e)}static load(e){let t=dt.deserialize(e);return new n(t)}},Ct= exports.TransactionPayloadMultiSig =class n extends qe{constructor(e){super(),this.multiSig=e}serialize(e){e.serializeU32AsUleb128(3),this.multiSig.serialize(e)}static load(e){let t=Et.deserialize(e);return new n(t)}},dt= exports.EntryFunction =class n{constructor(e,t,r,o){this.module_name=e,this.function_name=t,this.type_args=r,this.args=o}static build(e,t,r,o){return new n(St.fromStr(e),new E(t),r,o)}serialize(e){this.module_name.serialize(e),this.function_name.serialize(e),e.serializeVector(this.type_args),e.serializeU32AsUleb128(this.args.length),this.args.forEach(t=>{t.serializeForEntryFunction(e)})}static deserialize(e){let t=St.deserialize(e),r=E.deserialize(e),o=e.deserializeVector(N),s=e.deserializeUleb128AsU32(),i=new Array;for(let a=0;a<s;a+=1){let c=e.deserializeUleb128AsU32(),p=jt.deserialize(e,c);i.push(p)}return new n(t,r,o,i)}},Pt= exports.Script =class n{constructor(e,t,r){this.bytecode=e,this.type_args=t,this.args=r}serialize(e){e.serializeBytes(this.bytecode),e.serializeVector(this.type_args),e.serializeU32AsUleb128(this.args.length),this.args.forEach(t=>{t.serializeForScriptFunction(e)})}static deserialize(e){let t=e.deserializeBytes(),r=e.deserializeVector(N),o=e.deserializeUleb128AsU32(),s=new Array;for(let i=0;i<o;i+=1){let a=yi(e);s.push(a)}return new n(t,r,s)}},Et= exports.MultiSig =class n{constructor(e,t){this.multisig_address=e,this.transaction_payload=t}serialize(e){this.multisig_address.serialize(e),this.transaction_payload===void 0?e.serializeBool(!1):(e.serializeBool(!0),this.transaction_payload.serialize(e))}static deserialize(e){let t=u.deserialize(e),r=e.deserializeBool(),o;return r&&(o=It.deserialize(e)),new n(t,o)}},It= exports.MultiSigTransactionPayload =class n extends d{constructor(e){super(),this.transaction_payload=e}serialize(e){e.serializeU32AsUleb128(0),this.transaction_payload.serialize(e)}static deserialize(e){return e.deserializeUleb128AsU32(),new n(dt.deserialize(e))}};var ie=class n extends d{constructor(e,t,r,o,s,i,a){super(),this.sender=e,this.sequence_number=t,this.payload=r,this.max_gas_amount=o,this.gas_unit_price=s,this.expiration_timestamp_secs=i,this.chain_id=a}serialize(e){this.sender.serialize(e),e.serializeU64(this.sequence_number),this.payload.serialize(e),e.serializeU64(this.max_gas_amount),e.serializeU64(this.gas_unit_price),e.serializeU64(this.expiration_timestamp_secs),this.chain_id.serialize(e)}static deserialize(e){let t=u.deserialize(e),r=e.deserializeU64(),o=qe.deserialize(e),s=e.deserializeU64(),i=e.deserializeU64(),a=e.deserializeU64(),c=it.deserialize(e);return new n(t,r,o,s,i,a,c)}},yn= exports.RawTransactionWithData =class extends d{static deserialize(e){let t=e.deserializeUleb128AsU32();switch(t){case 0:return we.load(e);case 1:return _e.load(e);default:throw new Error(`Unknown variant index for RawTransactionWithData: ${t}`)}}},we= exports.MultiAgentRawTransaction =class n extends yn{constructor(e,t){super(),this.raw_txn=e,this.secondary_signer_addresses=t}serialize(e){e.serializeU32AsUleb128(0),this.raw_txn.serialize(e),e.serializeVector(this.secondary_signer_addresses)}static load(e){let t=ie.deserialize(e),r=e.deserializeVector(u);return new n(t,r)}},_e= exports.FeePayerRawTransaction =class n extends yn{constructor(e,t,r){super(),this.raw_txn=e,this.secondary_signer_addresses=t,this.fee_payer_address=r}serialize(e){e.serializeU32AsUleb128(1),this.raw_txn.serialize(e),e.serializeVector(this.secondary_signer_addresses),this.fee_payer_address.serialize(e)}static load(e){let t=ie.deserialize(e),r=e.deserializeVector(u),o=u.deserialize(e);return new n(t,r,o)}};var ge=class n extends d{constructor(e,t){super(),this.raw_txn=e,this.authenticator=t}serialize(e){this.raw_txn.serialize(e),this.authenticator.serialize(e)}static deserialize(e){let t=ie.deserialize(e),r=Te.deserialize(e);return new n(t,r)}};function Ro(n){return!!n.match(/^[_a-zA-Z0-9]+$/)}function No(n){return!!n.match(/\s/)}function Ai(n){return!!n.match(/^T[0-9]+$/)}function fi(n,e){let t=e;for(;t<n.length;t+=1){let r=n[t];if(!No(r))break}return t}var hi=(y=>(y.InvalidTypeTag="unknown type",y.UnexpectedGenericType="unexpected generic type",y.UnexpectedTypeArgumentClose="unexpected '>'",y.UnexpectedWhitespaceCharacter="unexpected whitespace character",y.UnexpectedComma="unexpected ','",y.TypeArgumentCountMismatch="type argument count doesn't match expected amount",y.MissingTypeArgumentClose="no matching '>' for '<'",y.UnexpectedPrimitiveTypeArguments="primitive types not expected to have type arguments",y.UnexpectedVectorTypeArgumentCount="vector type expected to have exactly one type argument",y.UnexpectedStructFormat="unexpected struct format, must be of the form 0xaddress::module_name::struct_name",y.InvalidModuleNameCharacter="module name must only contain alphanumeric or '_' characters",y.InvalidStructNameCharacter="struct name must only contain alphanumeric or '_' characters",y))(hi||{}),v= exports.TypeTagParserError =class extends Error{constructor(e,t){super(`Failed to parse typeTag '${e}', ${t}`)}};function $e(n,e){let t=_nullishCoalesce(_optionalChain([e, 'optionalAccess', _70 => _70.allowGenerics]), () => (!1)),r=[],o=[],s=[],i=0,a="",c=1;for(;i<n.length;){let p=n[i];if(p==="<")r.push({savedExpectedTypes:c,savedStr:a,savedTypes:s}),a="",s=[],c=1;else if(p===">"){if(a!==""){let Ge=An(a,o,t);s.push(Ge)}let f=r.pop();if(f===void 0)throw new v(n,"unexpected '>'");if(c!==s.length)throw new v(n,"type argument count doesn't match expected amount");let{savedStr:C,savedTypes:y,savedExpectedTypes:g}=f;o=s,s=y,a=C,c=g}else if(p===","){if(a.length!==0){let f=An(a,o,t);o=[],s.push(f),a="",c+=1}}else if(No(p)){let f=!1;if(a.length!==0){let y=An(a,o,t);o=[],s.push(y),a="",f=!0}i=fi(n,i);let C=n[i];if(i<n.length&&f&&C!==","&&C!==">")throw new v(n,"unexpected whitespace character");continue}else a+=p;i+=1}if(r.length>0)throw new v(n,"no matching '>' for '<'");switch(s.length){case 0:return An(a,o,t);case 1:if(a==="")return s[0];throw new v(n,"unexpected ','");default:throw new v(n,"unexpected whitespace character")}}function An(n,e,t){switch(n){case"&signer":if(e.length>0)throw new v(n,"primitive types not expected to have type arguments");return new mn(new Ke);case"signer":if(e.length>0)throw new v(n,"primitive types not expected to have type arguments");return new Ke;case"bool":if(e.length>0)throw new v(n,"primitive types not expected to have type arguments");return new O;case"address":if(e.length>0)throw new v(n,"primitive types not expected to have type arguments");return new Q;case"u8":if(e.length>0)throw new v(n,"primitive types not expected to have type arguments");return new le;case"u16":if(e.length>0)throw new v(n,"primitive types not expected to have type arguments");return new at;case"u32":if(e.length>0)throw new v(n,"primitive types not expected to have type arguments");return new ct;case"u64":if(e.length>0)throw new v(n,"primitive types not expected to have type arguments");return new $;case"u128":if(e.length>0)throw new v(n,"primitive types not expected to have type arguments");return new ut;case"u256":if(e.length>0)throw new v(n,"primitive types not expected to have type arguments");return new pt;case"vector":if(e.length!==1)throw new v(n,"vector type expected to have exactly one type argument");return new x(e[0]);default:if(Ai(n)){if(t)return new G(Number(n.split("T")[1]));throw new v(n,"unexpected generic type")}if(!n.match(/:/))throw new v(n,"unknown type");let r=n.split("::");if(r.length!==3)throw new v(n,"unexpected struct format, must be of the form 0xaddress::module_name::struct_name");if(!Ro(r[1]))throw new v(n,"module name must only contain alphanumeric or '_' characters");if(!Ro(r[2]))throw new v(n,"struct name must only contain alphanumeric or '_' characters");return new l(new be(u.fromString(r[0]),new E(r[1]),new E(r[2]),e))}}function Go(n){return typeof n=="boolean"}function lt(n){return typeof n=="string"}function fn(n){return typeof n=="number"}function hn(n){return typeof n=="number"||typeof n=="bigint"||typeof n=="string"}function ko(n){return n==null}function zo(n){return Jn(n)||tr(n)||nr(n)||rr(n)||or(n)||sr(n)||ir(n)||Tn(n)||er(n)||Ti(n)||n instanceof h||n instanceof Ce}function Jn(n){return n instanceof I}function Tn(n){return n instanceof u}function er(n){return n instanceof w}function Ti(n){return n instanceof Oe}function tr(n){return n instanceof z}function nr(n){return n instanceof te}function rr(n){return n instanceof ne}function or(n){return n instanceof k}function sr(n){return n instanceof re}function ir(n){return n instanceof oe}function Oo(n){return"bytecode"in n}function P(n,e){throw new Error(`Type mismatch for argument ${e}, expected '${n}'`)}function Do(n){let e=n.params.findIndex(t=>t!=="signer"&&t!=="&signer");return e<0?n.params.length:e}function ar(n){let e=n.split("::");if(e.length!==3)throw new Error(`Invalid function ${n}`);let t=e[0],r=e[1],o=e[2];return{moduleAddress:t,moduleName:r,functionName:o}}var bi=new TextEncoder;function Bo(n){return _nullishCoalesce(_optionalChain([n, 'optionalAccess', _71 => _71.map, 'call', _72 => _72(e=>lt(e)?$e(e):e)]), () => ([]))}async function Mo(n,e,t,r){let s=await _asyncOptionalChain([(await an({aptosConfig:r,accountAddress:n,moduleName:e})), 'access', async _73 => _73.abi, 'optionalAccess', async _74 => _74.exposed_functions, 'access', async _75 => _75.find, 'call', async _76 => _76(c=>c.name===t)]);if(!s)throw new Error(`Could not find entry function ABI for '${n}::${e}::${t}'`);if(!s.is_entry)throw new Error(`'${n}::${e}::${t}' is not an entry function`);let i=Do(s),a=[];for(let c=i;c<s.params.length;c+=1)a.push($e(s.params[c],{allowGenerics:!0}));return{typeParameters:s.generic_type_params,parameters:a}}function Fo(n,e,t,r,o){if(r>=e.parameters.length)throw new Error(`Too many arguments for '${n}', expected ${e.parameters.length}`);let s=e.parameters[r];return gt(t,s,r,o)}function gt(n,e,t,r){return zo(n)?(cr(e,n,t),n):wi(n,e,t,r)}function wi(n,e,t,r){if(e.isBool()){if(Go(n))return new I(n);P("boolean",t)}if(e.isAddress()){if(lt(n))return u.fromString(n);P("string | AccountAddress",t)}if(e.isU8()){if(fn(n))return new z(n);P("number",t)}if(e.isU16()){if(fn(n))return new te(n);P("number",t)}if(e.isU32()){if(fn(n))return new ne(n);P("number",t)}if(e.isU64()){if(hn(n))return new k(BigInt(n));P("bigint | number | string",t)}if(e.isU128()){if(hn(n))return new re(BigInt(n));P("bigint | number | string",t)}if(e.isU256()){if(hn(n))return new oe(BigInt(n));P("bigint | number | string",t)}if(e.isGeneric()){let o=e.value;if(o<0||o>=r.length)throw new Error(`Generic argument ${e.toString()} is invalid for argument ${t}`);return gt(n,r[o],t,r)}if(e.isVector()){if(e.value.isU8()){if(lt(n))return h.U8(bi.encode(n));if(n instanceof Uint8Array)return h.U8(n);if(n instanceof ArrayBuffer)return h.U8(new Uint8Array(n))}if(Array.isArray(n))return new h(n.map(o=>gt(o,e.value,t,r)));throw new Error(`Type mismatch for argument ${t}, type '${e.toString()}'`)}if(e.isStruct()){if(e.isString()){if(lt(n))return new w(n);P("string",t)}if(e.isObject()){if(lt(n))return u.fromString(n);P("string | AccountAddress",t)}if(e.isOption())return ko(n)?new Ce(null):new Ce(gt(n,e.value.typeArgs[0],t,r));throw new Error(`Unsupported struct input type for argument ${t}, type '${e.toString()}'`)}throw new Error(`Type mismatch for argument ${t}, type '${e.toString()}'`)}function cr(n,e,t){if(n.isBool()){if(Jn(e))return;P("Bool",t)}if(n.isAddress()){if(Tn(e))return;P("AccountAddress",t)}if(n.isU8()){if(tr(e))return;P("U8",t)}if(n.isU16()){if(nr(e))return;P("U16",t)}if(n.isU32()){if(rr(e))return;P("U32",t)}if(n.isU64()){if(or(e))return;P("U64",t)}if(n.isU128()){if(sr(e))return;P("U128",t)}if(n.isU256()){if(ir(e))return;P("U256",t)}if(n.isVector()){if(e instanceof h){e.values.length>0&&cr(n.value,e.values[0],t);return}P("MoveVector",t)}if(n instanceof l){if(n.isString()){if(er(e))return;P("MoveString",t)}if(n.isObject()){if(Tn(e))return;P("AccountAddress",t)}if(n.isOption()){if(e instanceof Ce){e.value!==void 0&&cr(n.value.typeArgs[0],e.value,t);return}P("MoveOption",t)}}throw new Error(`Type mismatch for argument ${t}, expected '${n.toString()}'`)}async function wn(n){if(Oo(n))return Si(n);let{moduleAddress:e,moduleName:t,functionName:r}=ar(n.function),o=await et(async()=>Mo(e,t,r,n.aptosConfig),`entry-function-${n.aptosConfig.network}-${e}-${t}-${r}`,1e3*60*5)();return _n({abi:o,...n})}function _n(n){let e=n.abi,{moduleAddress:t,moduleName:r,functionName:o}=ar(n.function),s=Bo(n.typeArguments);if(s.length!==e.typeParameters.length)throw new Error(`Type argument count mismatch, expected ${e.typeParameters.length}, received ${s.length}`);let i=n.functionArguments.map((c,p)=>Fo(n.function,e,c,p,s));if(i.length!==e.parameters.length)throw new Error(`Too few arguments for '${t}::${r}::${o}', expected ${e.parameters.length} but got ${i.length}`);let a=dt.build(`${t}::${r}`,o,s,i);if("multisigAddress"in n){let c=u.from(n.multisigAddress);return new Ct(new Et(c,new It(a)))}return new vt(a)}function Si(n){return new xt(new Pt(b.fromHexInput(n.bytecode).toUint8Array(),_nullishCoalesce(n.typeArguments, () => ([])),n.functionArguments))}async function xi(n){let{aptosConfig:e,sender:t,payload:r,options:o,feePayerAddress:s}=n,i=Yn[e.network]?Promise.resolve({chain_id:Yn[e.network]}):nn({aptosConfig:e}),a=_optionalChain([o, 'optionalAccess', _77 => _77.gasUnitPrice])?Promise.resolve({gas_estimate:o.gasUnitPrice}):un({aptosConfig:e}),[{chain_id:c},{gas_estimate:p}]=await Promise.all([i,a]),f=_optionalChain([o, 'optionalAccess', _78 => _78.accountSequenceNumber])!==void 0?Promise.resolve({sequence_number:o.accountSequenceNumber}):de({aptosConfig:e,accountAddress:t}),C;if(s&&u.from(s).equals(u.ZERO))try{let{sequence_number:ht}=await f;C=ht}catch (e2){C="0"}else{let{sequence_number:ht}=await f;C=ht}let{maxGasAmount:y,gasUnitPrice:g,expireTimestamp:Ge}={maxGasAmount:_optionalChain([o, 'optionalAccess', _79 => _79.maxGasAmount])?BigInt(o.maxGasAmount):BigInt(2e5),gasUnitPrice:BigInt(p),expireTimestamp:BigInt(Math.floor(Date.now()/1e3)+20),...o};return new ie(u.from(t),BigInt(C),r,BigInt(y),BigInt(g),BigInt(Ge),new it(c))}async function ur(n){let{aptosConfig:e,sender:t,payload:r,options:o,feePayerAddress:s}=n,i=await xi({aptosConfig:e,sender:t,payload:r,options:o,feePayerAddress:s});if("secondarySignerAddresses"in n){let a=_nullishCoalesce(_optionalChain([n, 'access', _80 => _80.secondarySignerAddresses, 'optionalAccess', _81 => _81.map, 'call', _82 => _82(c=>u.from(c))]), () => ([]));return{rawTransaction:i,secondarySignerAddresses:a,feePayerAddress:n.feePayerAddress?u.from(n.feePayerAddress):void 0}}return{rawTransaction:i,feePayerAddress:n.feePayerAddress?u.from(n.feePayerAddress):void 0}}function Ko(n){let{signerPublicKey:e,transaction:t,secondarySignersPublicKeys:r,feePayerPublicKey:o}=n,s=bn(e);if(t.feePayerAddress){let a=new _e(t.rawTransaction,_nullishCoalesce(t.secondarySignerAddresses, () => ([])),t.feePayerAddress),c=[];r&&(c=r.map(C=>bn(C)));let p=bn(o),f=new ot(s,_nullishCoalesce(t.secondarySignerAddresses, () => ([])),c,{address:t.feePayerAddress,authenticator:p});return new ge(a.raw_txn,f).bcsToBytes()}if(t.secondarySignerAddresses){let a=new we(t.rawTransaction,t.secondarySignerAddresses),c=[];c=r.map(f=>bn(f));let p=new rt(s,t.secondarySignerAddresses,c);return new ge(a.raw_txn,p).bcsToBytes()}let i;if(s instanceof pe)i=new nt(s.public_key,s.signature);else if(s instanceof se)i=new st(s);else throw new Error("Invalid public key");return new ge(t.rawTransaction,i).bcsToBytes()}function bn(n){if(n instanceof q){if(n.publicKey instanceof U)return new se(n,new B(new R(new Uint8Array(64))));if(n.publicKey instanceof fe)return new se(n,new B(new he(new Uint8Array(64))))}return new pe(new U(n.toUint8Array()),new R(new Uint8Array(64)))}function qo(n){let{signer:e,transaction:t}=n,r=pr(t);return e.signWithAuthenticator(r)}function $o(n){let{transaction:e,senderAuthenticator:t,feePayerAuthenticator:r,additionalSignersAuthenticators:o}=n,s=Lo(e);if((r||o)&&(s instanceof we||s instanceof _e))return vi(s,t,r,o);if(t instanceof pe&&s instanceof ie){let i=new nt(t.public_key,t.signature);return new ge(s,i).bcsToBytes()}if((t instanceof se||t instanceof Xe)&&s instanceof ie){let i=new st(t);return new ge(s,i).bcsToBytes()}throw new Error(`Cannot generate a signed transaction, ${t} is not a supported account authentication scheme`)}function Lo(n){return n.feePayerAddress?new _e(n.rawTransaction,_nullishCoalesce(n.secondarySignerAddresses, () => ([])),n.feePayerAddress):n.secondarySignerAddresses?new we(n.rawTransaction,n.secondarySignerAddresses):n.rawTransaction}function vi(n,e,t,r){if(n instanceof _e){if(!t)throw new Error("Must provide a feePayerAuthenticator argument to generate a signed fee payer transaction");let o=new ot(e,n.secondary_signer_addresses,_nullishCoalesce(r, () => ([])),{address:n.fee_payer_address,authenticator:t});return new ge(n.raw_txn,o).bcsToBytes()}if(n instanceof we){if(!r)throw new Error("Must provide a additionalSignersAuthenticators argument to generate a signed multi agent transaction");let o=new rt(e,n.secondary_signer_addresses,_nullishCoalesce(r, () => ([])));return new ge(n.raw_txn,o).bcsToBytes()}throw new Error(`Cannot prepare multi signers transaction to submission, ${typeof n} transaction is not supported`)}function pr(n){let e=Lo(n),t=_sha3.sha3_256.create();if(e instanceof ie)t.update(Gr);else if(e instanceof we)t.update(kn);else if(e instanceof _e)t.update(kn);else throw new Error(`Unknown transaction type to sign on: ${e}`);let r=t.digest(),o=e.bcsToBytes(),s=new Uint8Array(r.length+o.length);return s.set(r),s.set(o,r.length),s}async function A(n){let e=await Ci(n);return Pi(n,e)}async function Ci(n){let{aptosConfig:e,data:t}=n,r,o;return"bytecode"in t?o=await wn(t):"multisigAddress"in t?t.abi?o=_n({abi:t.abi,...t}):(r={aptosConfig:e,multisigAddress:t.multisigAddress,function:t.function,functionArguments:t.functionArguments,typeArguments:t.typeArguments},o=await wn(r)):t.abi?o=_n({abi:t.abi,...t}):(r={aptosConfig:e,function:t.function,functionArguments:t.functionArguments,typeArguments:t.typeArguments},o=await wn(r)),o}async function Pi(n,e){let{aptosConfig:t,sender:r,options:o}=n,s;if(Ei(n)&&(s=u.ZERO.toString()),Ii(n)){let{secondarySignerAddresses:i}=n;return ur({aptosConfig:t,sender:r,payload:e,options:o,secondarySignerAddresses:i,feePayerAddress:s})}return ur({aptosConfig:t,sender:r,payload:e,options:o,feePayerAddress:s})}function Ei(n){return n.withFeePayer===!0}function Ii(n){return"secondarySignerAddresses"in n}function Vo(n){let{transaction:e}=n;return pr(e)}function Sn(n){return qo({...n})}async function dr(n){let{aptosConfig:e,transaction:t,signerPublicKey:r,secondarySignersPublicKeys:o,feePayerPublicKey:s,options:i}=n,a=Ko({transaction:t,signerPublicKey:r,secondarySignersPublicKeys:o,feePayerPublicKey:s,options:i}),{data:c}=await He({aptosConfig:e,body:a,path:"transactions/simulate",params:{estimate_gas_unit_price:_nullishCoalesce(_optionalChain([n, 'access', _83 => _83.options, 'optionalAccess', _84 => _84.estimateGasUnitPrice]), () => (!1)),estimate_max_gas_amount:_nullishCoalesce(_optionalChain([n, 'access', _85 => _85.options, 'optionalAccess', _86 => _86.estimateMaxGasAmount]), () => (!1)),estimate_prioritized_gas_unit_price:_nullishCoalesce(_optionalChain([n, 'access', _87 => _87.options, 'optionalAccess', _88 => _88.estimatePrioritizedGasUnitPrice]), () => (!1))},originMethod:"simulateTransaction",contentType:"application/x.aptos.signed_transaction+bcs"});return c}async function xn(n){let{aptosConfig:e}=n,t=$o({...n}),{data:r}=await He({aptosConfig:e,body:t,path:"transactions",originMethod:"submitTransaction",contentType:"application/x.aptos.signed_transaction+bcs"});return r}async function Ut(n){let{aptosConfig:e,signer:t,transaction:r}=n,o=Sn({signer:t,transaction:r});return xn({aptosConfig:e,transaction:r,senderAuthenticator:o})}var Ui={typeParameters:[],parameters:[x.u8(),new x(x.u8())]};async function Ho(n){let{aptosConfig:e,account:t,metadataBytes:r,moduleBytecode:o,options:s}=n,i=o.map(a=>h.U8(a));return A({aptosConfig:e,sender:u.from(t),data:{function:"0x1::code::publish_package_txn",functionArguments:[h.U8(r),new h(i)],abi:Ui},options:s})}var Ri={typeParameters:[],parameters:[new le,x.u8(),new le,x.u8(),x.u8(),x.u8()]};async function Qo(n){let{aptosConfig:e,fromAccount:t,toNewPrivateKey:r}=n,o=await de({aptosConfig:e,accountAddress:t.accountAddress}),s=Ee.fromPrivateKey({privateKey:r,legacy:!0}),a=new gn({sequenceNumber:BigInt(o.sequence_number),originator:t.accountAddress,currentAuthKey:u.from(o.authentication_key),newPublicKey:s.publicKey}).bcsToBytes(),c=t.sign(a),p=s.sign(a),f=await A({aptosConfig:e,sender:t.accountAddress,data:{function:"0x1::account::rotate_authentication_key",functionArguments:[new z(t.signingScheme.valueOf()),h.U8(t.publicKey.toUint8Array()),new z(s.signingScheme.valueOf()),h.U8(s.publicKey.toUint8Array()),h.U8(c.toUint8Array()),h.U8(p.toUint8Array())],abi:Ri}});return Ut({aptosConfig:e,signer:t,transaction:f})}var Ni={typeParameters:[{constraints:[]}],parameters:[new Q,new $]};async function Wo(n){let{aptosConfig:e,sender:t,recipient:r,amount:o,coinType:s,options:i}=n;return A({aptosConfig:e,sender:t,data:{function:"0x1::aptos_account::transfer_coins",typeArguments:[_nullishCoalesce(s, () => (Vt))],functionArguments:[r,o],abi:Ni},options:i})}var Rt=class{constructor(e){this.config=e}async transferCoinTransaction(e){return Wo({aptosConfig:this.config,...e})}};var Re={BOOLEAN:"bool",U8:"u8",U16:"u16",U32:"u32",U64:"u64",U128:"u128",U256:"u256",ADDRESS:"address",STRING:"0x1::string::String",ARRAY:"vector<u8>"},J="0x4::token::Token";async function jo(n){let{aptosConfig:e,digitalAssetAddress:t}=n,r={token_data_id:{_eq:u.from(t).toStringLong()}};return(await m({aptosConfig:e,query:{query:uo,variables:{where_condition:r}},originMethod:"getDigitalAssetData"})).current_token_datas_v2[0]}async function Xo(n){let{aptosConfig:e,digitalAssetAddress:t}=n,r={token_data_id:{_eq:u.from(t).toStringLong()},amount:{_gt:0}};return(await m({aptosConfig:e,query:{query:Kn,variables:{where_condition:r}},originMethod:"getCurrentDigitalAssetOwnership"})).current_token_ownerships_v2[0]}async function Yo(n){let{aptosConfig:e,ownerAddress:t,options:r}=n,o={owner_address:{_eq:u.from(t).toStringLong()},amount:{_gt:0}},s={query:Kn,variables:{where_condition:o,offset:_optionalChain([r, 'optionalAccess', _89 => _89.offset]),limit:_optionalChain([r, 'optionalAccess', _90 => _90.limit]),order_by:_optionalChain([r, 'optionalAccess', _91 => _91.orderBy])}};return(await m({aptosConfig:e,query:s,originMethod:"getOwnedDigitalAssets"})).current_token_ownerships_v2}async function Zo(n){let{aptosConfig:e,digitalAssetAddress:t,options:r}=n,o={token_data_id:{_eq:u.from(t).toStringLong()}},s={query:co,variables:{where_condition:o,offset:_optionalChain([r, 'optionalAccess', _92 => _92.offset]),limit:_optionalChain([r, 'optionalAccess', _93 => _93.limit]),order_by:_optionalChain([r, 'optionalAccess', _94 => _94.orderBy])}};return(await m({aptosConfig:e,query:s,originMethod:"getDigitalAssetActivity"})).token_activities_v2}var Gi={typeParameters:[],parameters:[new l(S()),new $,new l(S()),new l(S()),new O,new O,new O,new O,new O,new O,new O,new O,new O,new $,new $]};async function Jo(n){let{aptosConfig:e,options:t,creator:r}=n;return A({aptosConfig:e,sender:r.accountAddress,data:{function:"0x4::aptos_token::create_collection",functionArguments:[new w(n.description),new k(_nullishCoalesce(n.maxSupply, () => (ke))),new w(n.name),new w(n.uri),new I(_nullishCoalesce(n.mutableDescription, () => (!0))),new I(_nullishCoalesce(n.mutableRoyalty, () => (!0))),new I(_nullishCoalesce(n.mutableURI, () => (!0))),new I(_nullishCoalesce(n.mutableTokenDescription, () => (!0))),new I(_nullishCoalesce(n.mutableTokenName, () => (!0))),new I(_nullishCoalesce(n.mutableTokenProperties, () => (!0))),new I(_nullishCoalesce(n.mutableTokenURI, () => (!0))),new I(_nullishCoalesce(n.tokensBurnableByCreator, () => (!0))),new I(_nullishCoalesce(n.tokensFreezableByCreator, () => (!0))),new k(_nullishCoalesce(n.royaltyNumerator, () => (0))),new k(_nullishCoalesce(n.royaltyDenominator, () => (1)))],abi:Gi},options:t})}async function lr(n){let{aptosConfig:e,creatorAddress:t,collectionName:r,options:o}=n,s=u.from(t),i={collection_name:{_eq:r},creator_address:{_eq:s.toStringLong()}};return _optionalChain([o, 'optionalAccess', _95 => _95.tokenStandard])&&(i.token_standard={_eq:_nullishCoalesce(_optionalChain([o, 'optionalAccess', _96 => _96.tokenStandard]), () => ("v2"))}),(await m({aptosConfig:e,query:{query:Bn,variables:{where_condition:i}},originMethod:"getCollectionData"})).current_collections_v2[0]}async function es(n){let{aptosConfig:e,collectionId:t}=n,o={collection_id:{_eq:u.from(t).toStringLong()}};return(await m({aptosConfig:e,query:{query:Bn,variables:{where_condition:o}},originMethod:"getCollectionData"})).current_collections_v2[0]}async function ts(n){return(await lr(n)).collection_id}var ki={typeParameters:[],parameters:[new l(S()),new l(S()),new l(S()),new l(S()),new x(new l(S())),new x(new l(S())),new x(x.u8())]};async function ns(n){let{aptosConfig:e,options:t,creator:r,collection:o,description:s,name:i,uri:a,propertyKeys:c,propertyTypes:p,propertyValues:f}=n,C=_optionalChain([p, 'optionalAccess', _97 => _97.map, 'call', _98 => _98(y=>Re[y])]);return A({aptosConfig:e,sender:r.accountAddress,data:{function:"0x4::aptos_token::mint",functionArguments:[new w(o),new w(s),new w(i),new w(a),h.MoveString(_nullishCoalesce(c, () => ([]))),h.MoveString(_nullishCoalesce(C, () => ([]))),As(_nullishCoalesce(f, () => ([])),_nullishCoalesce(C, () => ([])))],abi:ki},options:t})}var zi={typeParameters:[{constraints:["key"]}],parameters:[new l(W(new G(0))),new Q]};async function rs(n){let{aptosConfig:e,sender:t,digitalAssetAddress:r,recipient:o,digitalAssetType:s,options:i}=n;return A({aptosConfig:e,sender:t.accountAddress,data:{function:"0x1::object::transfer",typeArguments:[_nullishCoalesce(s, () => (J))],functionArguments:[u.from(r),u.from(o)],abi:zi},options:i})}var Oi={typeParameters:[],parameters:[new l(S()),new l(S()),new l(S()),new l(S()),new x(new l(S())),new x(new l(S())),new x(x.u8()),new Q]};async function os(n){let{aptosConfig:e,account:t,collection:r,description:o,name:s,uri:i,recipient:a,propertyKeys:c,propertyTypes:p,propertyValues:f,options:C}=n;if(_optionalChain([c, 'optionalAccess', _99 => _99.length])!==_optionalChain([f, 'optionalAccess', _100 => _100.length]))throw new Error("Property keys and property values counts do not match");if(_optionalChain([p, 'optionalAccess', _101 => _101.length])!==_optionalChain([f, 'optionalAccess', _102 => _102.length]))throw new Error("Property types and property values counts do not match");let y=_optionalChain([p, 'optionalAccess', _103 => _103.map, 'call', _104 => _104(g=>Re[g])]);return A({aptosConfig:e,sender:t.accountAddress,data:{function:"0x4::aptos_token::mint_soul_bound",functionArguments:[r,o,s,i,h.MoveString(_nullishCoalesce(c, () => ([]))),h.MoveString(_nullishCoalesce(y, () => ([]))),As(_nullishCoalesce(f, () => ([])),_nullishCoalesce(y, () => ([]))),a],abi:Oi},options:C})}var Di={typeParameters:[{constraints:["key"]}],parameters:[new l(W(new G(0)))]};async function ss(n){let{aptosConfig:e,creator:t,digitalAssetAddress:r,digitalAssetType:o,options:s}=n;return A({aptosConfig:e,sender:t.accountAddress,data:{function:"0x4::aptos_token::burn",typeArguments:[_nullishCoalesce(o, () => (J))],functionArguments:[u.from(r)],abi:Di},options:s})}var Bi={typeParameters:[{constraints:["key"]}],parameters:[new l(W(new G(0)))]};async function is(n){let{aptosConfig:e,creator:t,digitalAssetAddress:r,digitalAssetType:o,options:s}=n;return A({aptosConfig:e,sender:t.accountAddress,data:{function:"0x4::aptos_token::freeze_transfer",typeArguments:[_nullishCoalesce(o, () => (J))],functionArguments:[r],abi:Bi},options:s})}var Mi={typeParameters:[{constraints:["key"]}],parameters:[new l(W(new G(0)))]};async function as(n){let{aptosConfig:e,creator:t,digitalAssetAddress:r,digitalAssetType:o,options:s}=n;return A({aptosConfig:e,sender:t.accountAddress,data:{function:"0x4::aptos_token::unfreeze_transfer",typeArguments:[_nullishCoalesce(o, () => (J))],functionArguments:[r],abi:Mi},options:s})}var Fi={typeParameters:[{constraints:["key"]}],parameters:[new l(W(new G(0))),new l(S())]};async function cs(n){let{aptosConfig:e,creator:t,description:r,digitalAssetAddress:o,digitalAssetType:s,options:i}=n;return A({aptosConfig:e,sender:t.accountAddress,data:{function:"0x4::aptos_token::set_description",typeArguments:[_nullishCoalesce(s, () => (J))],functionArguments:[u.from(o),new w(r)],abi:Fi},options:i})}var Ki={typeParameters:[{constraints:["key"]}],parameters:[new l(W(new G(0))),new l(S())]};async function us(n){let{aptosConfig:e,creator:t,name:r,digitalAssetAddress:o,digitalAssetType:s,options:i}=n;return A({aptosConfig:e,sender:t.accountAddress,data:{function:"0x4::aptos_token::set_name",typeArguments:[_nullishCoalesce(s, () => (J))],functionArguments:[u.from(o),new w(r)],abi:Ki},options:i})}var qi={typeParameters:[{constraints:["key"]}],parameters:[new l(W(new G(0))),new l(S())]};async function ps(n){let{aptosConfig:e,creator:t,uri:r,digitalAssetAddress:o,digitalAssetType:s,options:i}=n;return A({aptosConfig:e,sender:t.accountAddress,data:{function:"0x4::aptos_token::set_uri",typeArguments:[_nullishCoalesce(s, () => (J))],functionArguments:[u.from(o),new w(r)],abi:qi},options:i})}var $i={typeParameters:[{constraints:["key"]}],parameters:[new l(W(new G(0))),new l(S()),new l(S()),x.u8()]};async function ds(n){let{aptosConfig:e,creator:t,propertyKey:r,propertyType:o,propertyValue:s,digitalAssetAddress:i,digitalAssetType:a,options:c}=n;return A({aptosConfig:e,sender:t.accountAddress,data:{function:"0x4::aptos_token::add_property",typeArguments:[_nullishCoalesce(a, () => (J))],functionArguments:[u.from(i),new w(r),new w(Re[o]),h.U8(gr(s,Re[o]))],abi:$i},options:c})}var Li={typeParameters:[{constraints:["key"]}],parameters:[new l(W(new G(0))),new l(S())]};async function ls(n){let{aptosConfig:e,creator:t,propertyKey:r,digitalAssetAddress:o,digitalAssetType:s,options:i}=n;return A({aptosConfig:e,sender:t.accountAddress,data:{function:"0x4::aptos_token::remove_property",typeArguments:[_nullishCoalesce(s, () => (J))],functionArguments:[u.from(o),new w(r)],abi:Li},options:i})}var Vi={typeParameters:[{constraints:["key"]}],parameters:[new l(W(new G(0))),new l(S()),new l(S()),x.u8()]};async function gs(n){let{aptosConfig:e,creator:t,propertyKey:r,propertyType:o,propertyValue:s,digitalAssetAddress:i,digitalAssetType:a,options:c}=n;return A({aptosConfig:e,sender:t.accountAddress,data:{function:"0x4::aptos_token::update_property",typeArguments:[_nullishCoalesce(a, () => (J))],functionArguments:[u.from(i),new w(r),new w(Re[o]),gr(s,Re[o])],abi:Vi},options:c})}var Hi={typeParameters:[{constraints:["key"]},{constraints:[]}],parameters:[new l(W(new G(0))),new l(S()),new G(1)]};async function ms(n){let{aptosConfig:e,creator:t,propertyKey:r,propertyType:o,propertyValue:s,digitalAssetAddress:i,digitalAssetType:a,options:c}=n;return A({aptosConfig:e,sender:t.accountAddress,data:{function:"0x4::aptos_token::add_typed_property",typeArguments:[_nullishCoalesce(a, () => (J)),Re[o]],functionArguments:[u.from(i),new w(r),s],abi:Hi},options:c})}var Qi={typeParameters:[{constraints:["key"]},{constraints:[]}],parameters:[new l(W(new G(0))),new l(S()),new G(1)]};async function ys(n){let{aptosConfig:e,creator:t,propertyKey:r,propertyType:o,propertyValue:s,digitalAssetAddress:i,digitalAssetType:a,options:c}=n;return A({aptosConfig:e,sender:t.accountAddress,data:{function:"0x4::aptos_token::update_typed_property",typeArguments:[_nullishCoalesce(a, () => (J)),Re[o]],functionArguments:[u.from(i),new w(r),s],abi:Qi},options:c})}function As(n,e){let t=new Array;return e.forEach((r,o)=>{t.push(gr(n[o],r))}),t}function gr(n,e){let t=$e(e);return gt(n,t,0,[]).bcsToBytes()}var Nt=class{constructor(e){this.config=e}async getCollectionData(e){return await T({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"token_v2_processor"}),lr({aptosConfig:this.config,...e})}async getCollectionDataByCollectionId(e){return await T({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"token_v2_processor"}),es({aptosConfig:this.config,...e})}async getCollectionId(e){return await T({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"token_v2_processor"}),ts({aptosConfig:this.config,...e})}async getDigitalAssetData(e){return await T({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"token_v2_processor"}),jo({aptosConfig:this.config,...e})}async getCurrentDigitalAssetOwnership(e){return await T({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"token_v2_processor"}),Xo({aptosConfig:this.config,...e})}async getOwnedDigitalAssets(e){return await T({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"token_v2_processor"}),Yo({aptosConfig:this.config,...e})}async getDigitalAssetActivity(e){return await T({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"token_v2_processor"}),Zo({aptosConfig:this.config,...e})}async createCollectionTransaction(e){return Jo({aptosConfig:this.config,...e})}async mintDigitalAssetTransaction(e){return ns({aptosConfig:this.config,...e})}async transferDigitalAssetTransaction(e){return rs({aptosConfig:this.config,...e})}async mintSoulBoundTransaction(e){return os({aptosConfig:this.config,...e})}async burnDigitalAssetTransaction(e){return ss({aptosConfig:this.config,...e})}async freezeDigitalAssetTransaferTransaction(e){return is({aptosConfig:this.config,...e})}async unfreezeDigitalAssetTransaferTransaction(e){return as({aptosConfig:this.config,...e})}async setDigitalAssetDescriptionTransaction(e){return cs({aptosConfig:this.config,...e})}async setDigitalAssetNameTransaction(e){return us({aptosConfig:this.config,...e})}async setDigitalAssetURITransaction(e){return ps({aptosConfig:this.config,...e})}async addDigitalAssetPropertyTransaction(e){return ds({aptosConfig:this.config,...e})}async removeDigitalAssetPropertyTransaction(e){return ls({aptosConfig:this.config,...e})}async updateDigitalAssetPropertyTransaction(e){return gs({aptosConfig:this.config,...e})}async addDigitalAssetTypedPropertyTransaction(e){return ms({aptosConfig:this.config,...e})}async updateDigitalAssetTypedPropertyTransaction(e){return ys({aptosConfig:this.config,...e})}};var fs=300,Wi=n=>{if(n&&n.length>fs)throw new Error(`Event type length exceeds the maximum length of ${fs}`)};async function hs(n){let{aptosConfig:e,eventType:t,options:r}=n,s={where:{account_address:{_eq:"0x0000000000000000000000000000000000000000000000000000000000000000"},creation_number:{_eq:"0"},sequence_number:{_eq:"0"},indexed_type:{_eq:t}},pagination:r,orderBy:_optionalChain([r, 'optionalAccess', _105 => _105.orderBy])};return Gt({aptosConfig:e,options:s})}async function Ts(n){let{accountAddress:e,aptosConfig:t,creationNumber:r,options:o}=n,a={where:{account_address:{_eq:u.from(e).toStringLong()},creation_number:{_eq:r}},pagination:o,orderBy:_optionalChain([o, 'optionalAccess', _106 => _106.orderBy])};return Gt({aptosConfig:t,options:a})}async function bs(n){let{accountAddress:e,aptosConfig:t,eventType:r,options:o}=n,a={where:{account_address:{_eq:u.from(e).toStringLong()},indexed_type:{_eq:r}},pagination:o,orderBy:_optionalChain([o, 'optionalAccess', _107 => _107.orderBy])};return Gt({aptosConfig:t,options:a})}async function Gt(n){let{aptosConfig:e,options:t}=n;Wi(_optionalChain([t, 'optionalAccess', _108 => _108.where, 'optionalAccess', _109 => _109.indexed_type, 'optionalAccess', _110 => _110._eq]));let r={query:so,variables:{where_condition:_optionalChain([t, 'optionalAccess', _111 => _111.where]),offset:_optionalChain([t, 'optionalAccess', _112 => _112.offset]),limit:_optionalChain([t, 'optionalAccess', _113 => _113.limit]),order_by:_optionalChain([t, 'optionalAccess', _114 => _114.orderBy])}};return(await m({aptosConfig:e,query:r,originMethod:"getEvents"})).events}var kt=class{constructor(e){this.config=e}async getModuleEventsByEventType(e){return await T({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"events_processor"}),hs({aptosConfig:this.config,...e})}async getAccountEventsByCreationNumber(e){return await T({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"events_processor"}),Ts({aptosConfig:this.config,...e})}async getAccountEventsByEventType(e){return await T({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"events_processor"}),bs({aptosConfig:this.config,...e})}async getEvents(e){return await T({config:this.config,minimumLedgerVersion:_optionalChain([e, 'optionalAccess', _115 => _115.minimumLedgerVersion]),processorType:"events_processor"}),Gt({aptosConfig:this.config,...e})}};async function ws(n){let{aptosConfig:e,accountAddress:t,amount:r,options:o}=n,s=_optionalChain([o, 'optionalAccess', _116 => _116.timeoutSecs])||20,{data:i}=await Or({aptosConfig:e,path:"fund",body:{address:u.from(t).toString(),amount:r},originMethod:"fundAccount"}),a=i.txn_hashes[0],c=await tt({aptosConfig:e,transactionHash:a,options:{timeoutSecs:s,checkSuccess:_optionalChain([o, 'optionalAccess', _117 => _117.checkSuccess])}});if(c.type==="user_transaction")return c;throw new Error(`Unexpected transaction received for fund account: ${c.type}`)}var zt=class{constructor(e){this.config=e}async fundAccount(e){let t=await ws({aptosConfig:this.config,...e});return _optionalChain([e, 'access', _118 => _118.options, 'optionalAccess', _119 => _119.waitForIndexer])!==!1&&await dn({aptosConfig:this.config,minimumLedgerVersion:BigInt(t.version)}),t}};async function mr(n){let{aptosConfig:e,options:t}=n,r={query:ao,variables:{where_condition:_optionalChain([t, 'optionalAccess', _120 => _120.where]),limit:_optionalChain([t, 'optionalAccess', _121 => _121.limit]),offset:_optionalChain([t, 'optionalAccess', _122 => _122.offset])}};return(await m({aptosConfig:e,query:r,originMethod:"getFungibleAssetMetadata"})).fungible_asset_metadata}async function _s(n){let{aptosConfig:e,options:t}=n,r={query:io,variables:{where_condition:_optionalChain([t, 'optionalAccess', _123 => _123.where]),limit:_optionalChain([t, 'optionalAccess', _124 => _124.limit]),offset:_optionalChain([t, 'optionalAccess', _125 => _125.offset])}};return(await m({aptosConfig:e,query:r,originMethod:"getFungibleAssetActivities"})).fungible_asset_activities}async function Ss(n){let{aptosConfig:e,options:t}=n,r={query:ro,variables:{where_condition:_optionalChain([t, 'optionalAccess', _126 => _126.where]),limit:_optionalChain([t, 'optionalAccess', _127 => _127.limit]),offset:_optionalChain([t, 'optionalAccess', _128 => _128.offset])}};return(await m({aptosConfig:e,query:r,originMethod:"getCurrentFungibleAssetBalances"})).current_fungible_asset_balances}var ji={typeParameters:[],parameters:[$e("0x1::object::Object"),new Q,new $]};async function xs(n){let{aptosConfig:e,sender:t,fungibleAssetMetadataAddress:r,recipient:o,amount:s,options:i}=n;return A({aptosConfig:e,sender:t.accountAddress,data:{function:"0x1::primary_fungible_store::transfer",typeArguments:["0x1::fungible_asset::Metadata"],functionArguments:[r,o,s],abi:ji},options:i})}var Ot=class{constructor(e){this.config=e}async getFungibleAssetMetadata(e){return await T({config:this.config,minimumLedgerVersion:_optionalChain([e, 'optionalAccess', _129 => _129.minimumLedgerVersion]),processorType:"fungible_asset_processor"}),mr({aptosConfig:this.config,...e})}async getFungibleAssetMetadataByAssetType(e){return await T({config:this.config,minimumLedgerVersion:_optionalChain([e, 'optionalAccess', _130 => _130.minimumLedgerVersion]),processorType:"fungible_asset_processor"}),(await mr({aptosConfig:this.config,options:{where:{asset_type:{_eq:e.assetType}}}}))[0]}async getFungibleAssetActivities(e){return await T({config:this.config,minimumLedgerVersion:_optionalChain([e, 'optionalAccess', _131 => _131.minimumLedgerVersion]),processorType:"fungible_asset_processor"}),_s({aptosConfig:this.config,...e})}async getCurrentFungibleAssetBalances(e){return await T({config:this.config,minimumLedgerVersion:_optionalChain([e, 'optionalAccess', _132 => _132.minimumLedgerVersion]),processorType:"fungible_asset_processor"}),Ss({aptosConfig:this.config,...e})}async transferFungibleAsset(e){return xs({aptosConfig:this.config,...e})}};var Dt=class{constructor(e){this.config=e}async getLedgerInfo(){return nn({aptosConfig:this.config})}async getChainId(){return(await this.getLedgerInfo()).chain_id}async getBlockByVersion(e){return po({aptosConfig:this.config,...e})}async getBlockByHeight(e){return lo({aptosConfig:this.config,...e})}async getTableItem(e){return rn({aptosConfig:this.config,...e})}async view(e){return Ie({aptosConfig:this.config,...e})}async getChainTopUserTransactions(e){return go({aptosConfig:this.config,...e})}async queryIndexer(e){return m({aptosConfig:this.config,...e})}async getIndexerLastSuccessVersion(){return on({aptosConfig:this.config})}async getProcessorStatus(e){return sn({aptosConfig:this.config,processorType:e})}};var vs=["A name must be between 3 and 63 characters long,","and can only contain lowercase a-z, 0-9, and hyphens.","A name may not start or end with a hyphen."].join(" ");function Cs(n){return!(!n||n.length<3||n.length>63||!/^[a-z\d][a-z\d-]{1,61}[a-z\d]$/.test(n))}function Ne(n){let[e,t,...r]=n.replace(/\.apt$/,"").split(".");if(r.length>0)throw new Error(`${n} is invalid. A name can only have two parts, a domain and a subdomain separated by a "."`);if(!Cs(e))throw new Error(`${e} is not valid. ${vs}`);if(t&&!Cs(t))throw new Error(`${t} is not valid. ${vs}`);return{domainName:t||e,subdomainName:t?e:void 0}}var Xi="0x585fc9f0f0c54183b039ffc770ca282ebd87307916c215a3e692f2f8e4305e82",Yi={testnet:"0x5f8fd2347449685cf41d4db97926ec3a096eaf381332be4f1318ad4d16a8497c",mainnet:"0x867ed1f6bf916171b1de3ee92849b8978b7d1b9e0a8cc982a3d19d535dfd9c0c",local:Xi,custom:null,devnet:null,randomnet:null};function Se(n){let e=Yi[n.network];if(!e)throw new Error(`The ANS contract is not deployed to ${n.network}`);return e}var Zi=n=>({vec:[n]}),Ji=()=>({vec:[]}),yr=n=>n!=null?Zi(n):Ji(),vn=n=>{if(n&&typeof n=="object"&&"vec"in n&&Array.isArray(n.vec))return n.vec[0]};async function Ps(n){let{aptosConfig:e,name:t}=n,r=Se(e),{domainName:o,subdomainName:s}=Ne(t),i=await Ie({aptosConfig:e,payload:{function:`${r}::router::get_owner_addr`,functionArguments:[o,yr(s)]}}),a=vn(i[0]);return a?u.from(a).toString():void 0}async function Es(n){let{aptosConfig:e,expiration:t,name:r,sender:o,targetAddress:s,toAddress:i,options:a,transferable:c}=n,p=Se(e),{domainName:f,subdomainName:C}=Ne(r),y=t.policy==="subdomain:independent"||t.policy==="subdomain:follow-domain";if(C&&!y)throw new Error("Subdomains must have an expiration policy of either 'subdomain:independent' or 'subdomain:follow-domain'");if(y&&!C)throw new Error(`Policy is set to ${t.policy} but no subdomain was provided`);if(t.policy==="domain"){let br=_nullishCoalesce(t.years, () => (1));if(br!==1)throw new Error("For now, names can only be registered for 1 year at a time");let Ls=br*31536e3;return await A({aptosConfig:e,sender:o.accountAddress.toString(),data:{function:`${p}::router::register_domain`,functionArguments:[f,Ls,s,i]},options:a})}if(!C)throw new Error(`${t.policy} requires a subdomain to be provided.`);let g=await Ar({aptosConfig:e,name:f});if(!g)throw new Error("The domain does not exist");let Ge=t.policy==="subdomain:independent"?t.expirationDate:g;if(Ge>g)throw new Error("The subdomain expiration time cannot be greater than the domain expiration time");return await A({aptosConfig:e,sender:o.accountAddress.toString(),data:{function:`${p}::router::register_subdomain`,functionArguments:[f,C,Math.round(Ge/1e3),t.policy==="subdomain:follow-domain"?1:0,!!c,s,i]},options:a})}async function Ar(n){let{aptosConfig:e,name:t}=n,r=Se(e),{domainName:o,subdomainName:s}=Ne(t);try{let i=await Ie({aptosConfig:e,payload:{function:`${r}::router::get_expiration`,functionArguments:[o,yr(s)]}});return Number(i[0])*1e3}catch (e3){return}}async function Is(n){let{aptosConfig:e,address:t}=n,r=Se(e),o=await Ie({aptosConfig:e,payload:{function:`${r}::router::get_primary_name`,functionArguments:[u.from(t).toString()]}}),s=vn(o[1]),i=vn(o[0]);if(s)return[i,s].filter(Boolean).join(".")}async function Us(n){let{aptosConfig:e,sender:t,name:r,options:o}=n,s=Se(e);if(!r)return await A({aptosConfig:e,sender:t.accountAddress.toString(),data:{function:`${s}::router::clear_primary_name`,functionArguments:[]},options:o});let{domainName:i,subdomainName:a}=Ne(r);return await A({aptosConfig:e,sender:t.accountAddress.toString(),data:{function:`${s}::router::set_primary_name`,functionArguments:[i,a]},options:o})}async function Rs(n){let{aptosConfig:e,name:t}=n,r=Se(e),{domainName:o,subdomainName:s}=Ne(t),i=await Ie({aptosConfig:e,payload:{function:`${r}::router::get_target_addr`,functionArguments:[o,yr(s)]}}),a=vn(i[0]);return a?u.from(a).toString():void 0}async function Ns(n){let{aptosConfig:e,sender:t,name:r,address:o,options:s}=n,i=Se(e),{domainName:a,subdomainName:c}=Ne(r);return await A({aptosConfig:e,sender:t.accountAddress.toString(),data:{function:`${i}::router::set_target_addr`,functionArguments:[a,c,o]},options:s})}async function Gs(n){let{aptosConfig:e,name:t}=n,{domainName:r,subdomainName:o=""}=Ne(t),a=(await m({aptosConfig:e,query:{query:Je,variables:{where_condition:{domain:{_eq:r},subdomain:{_eq:o}},limit:1}},originMethod:"getName"})).current_aptos_names[0];return a&&(a=Bt(a)),a}async function ks(n){let{aptosConfig:e,options:t,accountAddress:r}=n,o=await fr({aptosConfig:e});return(await m({aptosConfig:e,originMethod:"getAccountNames",query:{query:Je,variables:{limit:_optionalChain([t, 'optionalAccess', _133 => _133.limit]),offset:_optionalChain([t, 'optionalAccess', _134 => _134.offset]),order_by:_optionalChain([t, 'optionalAccess', _135 => _135.orderBy]),where_condition:{..._nullishCoalesce(_optionalChain([n, 'access', _136 => _136.options, 'optionalAccess', _137 => _137.where]), () => ({})),owner_address:{_eq:r.toString()},expiration_timestamp:{_gte:o}}}}})).current_aptos_names.map(Bt)}async function zs(n){let{aptosConfig:e,options:t,accountAddress:r}=n,o=await fr({aptosConfig:e});return(await m({aptosConfig:e,originMethod:"getAccountDomains",query:{query:Je,variables:{limit:_optionalChain([t, 'optionalAccess', _138 => _138.limit]),offset:_optionalChain([t, 'optionalAccess', _139 => _139.offset]),order_by:_optionalChain([t, 'optionalAccess', _140 => _140.orderBy]),where_condition:{..._nullishCoalesce(_optionalChain([n, 'access', _141 => _141.options, 'optionalAccess', _142 => _142.where]), () => ({})),owner_address:{_eq:r.toString()},expiration_timestamp:{_gte:o},subdomain:{_eq:""}}}}})).current_aptos_names.map(Bt)}async function Os(n){let{aptosConfig:e,options:t,accountAddress:r}=n,o=await fr({aptosConfig:e});return(await m({aptosConfig:e,originMethod:"getAccountSubdomains",query:{query:Je,variables:{limit:_optionalChain([t, 'optionalAccess', _143 => _143.limit]),offset:_optionalChain([t, 'optionalAccess', _144 => _144.offset]),order_by:_optionalChain([t, 'optionalAccess', _145 => _145.orderBy]),where_condition:{..._nullishCoalesce(_optionalChain([n, 'access', _146 => _146.options, 'optionalAccess', _147 => _147.where]), () => ({})),owner_address:{_eq:r.toString()},expiration_timestamp:{_gte:o},subdomain:{_neq:""}}}}})).current_aptos_names.map(Bt)}async function Ds(n){let{aptosConfig:e,options:t,domain:r}=n;return(await m({aptosConfig:e,originMethod:"getDomainSubdomains",query:{query:Je,variables:{limit:_optionalChain([t, 'optionalAccess', _148 => _148.limit]),offset:_optionalChain([t, 'optionalAccess', _149 => _149.offset]),order_by:_optionalChain([t, 'optionalAccess', _150 => _150.orderBy]),where_condition:{..._nullishCoalesce(_optionalChain([n, 'access', _151 => _151.options, 'optionalAccess', _152 => _152.where]), () => ({})),domain:{_eq:r},subdomain:{_neq:""}}}}})).current_aptos_names.map(Bt)}async function fr(n){let{aptosConfig:e}=n,t=Se(e),[r]=await Ie({aptosConfig:e,payload:{function:`${t}::config::reregistration_grace_sec`,functionArguments:[]}}),o=r/60/60/24,s=()=>new Date;return new Date(s().setDate(s().getDate()-o)).toISOString()}async function Bs(n){let{aptosConfig:e,sender:t,name:r,years:o=1,options:s}=n,i=Se(e),a=o*31536e3,{domainName:c,subdomainName:p}=Ne(r);if(p)throw new Error("Subdomains cannot be renewed");if(o!==1)throw new Error("Currently, only 1 year renewals are supported");return await A({aptosConfig:e,sender:t.accountAddress.toString(),data:{function:`${i}::router::renew_domain`,functionArguments:[c,a]},options:s})}function Bt(n){return{...n,expiration_timestamp:new Date(n.expiration_timestamp).valueOf()}}var Mt=class{constructor(e){this.config=e}async getOwnerAddress(e){return Ps({aptosConfig:this.config,...e})}async getExpiration(e){return Ar({aptosConfig:this.config,...e})}async getTargetAddress(e){return Rs({aptosConfig:this.config,...e})}async setTargetAddress(e){return Ns({aptosConfig:this.config,...e})}async getPrimaryName(e){return Is({aptosConfig:this.config,...e})}async setPrimaryName(e){return Us({aptosConfig:this.config,...e})}async registerName(e){return Es({aptosConfig:this.config,...e})}async renewDomain(e){return Bs({aptosConfig:this.config,...e})}async getName(e){return Gs({aptosConfig:this.config,...e})}async getAccountNames(e){return ks({aptosConfig:this.config,...e})}async getAccountDomains(e){return zs({aptosConfig:this.config,...e})}async getAccountSubdomains(e){return Os({aptosConfig:this.config,...e})}async getDomainSubdomains(e){return Ds({aptosConfig:this.config,...e})}};async function Ms(n){let{aptosConfig:e,poolAddress:t}=n,r=u.from(t).toStringLong(),s=await m({aptosConfig:e,query:{query:Mn,variables:{where_condition:{pool_address:{_eq:r}}}}});return s.num_active_delegator_per_pool[0]?s.num_active_delegator_per_pool[0].num_active_delegator:0}async function Fs(n){let{aptosConfig:e,options:t}=n,r={query:Mn,variables:{order_by:_optionalChain([t, 'optionalAccess', _153 => _153.orderBy])}};return(await m({aptosConfig:e,query:r})).num_active_delegator_per_pool}async function Ks(n){let{aptosConfig:e,delegatorAddress:t,poolAddress:r}=n,o={query:oo,variables:{delegatorAddress:u.from(t).toStringLong(),poolAddress:u.from(r).toStringLong()}};return(await m({aptosConfig:e,query:o})).delegated_staking_activities}var Ft=class{constructor(e){this.config=e}async getNumberOfDelegators(e){return await T({config:this.config,minimumLedgerVersion:_optionalChain([e, 'optionalAccess', _154 => _154.minimumLedgerVersion]),processorType:"stake_processor"}),Ms({aptosConfig:this.config,...e})}async getNumberOfDelegatorsForAllPools(e){return await T({config:this.config,minimumLedgerVersion:_optionalChain([e, 'optionalAccess', _155 => _155.minimumLedgerVersion]),processorType:"stake_processor"}),Fs({aptosConfig:this.config,...e})}async getDelegatedStakingActivities(e){return await T({config:this.config,minimumLedgerVersion:_optionalChain([e, 'optionalAccess', _156 => _156.minimumLedgerVersion]),processorType:"stake_processor"}),Ks({aptosConfig:this.config,...e})}};var Cn=class{constructor(e){this.config=e}async simple(e){return A({aptosConfig:this.config,...e})}async multiAgent(e){return A({aptosConfig:this.config,...e})}};function hr(n,e,t){let r=t.value;return t.value=async function(...o){let[s]=o;if(s.transaction.feePayerAddress&&!s.feePayerAuthenticator)throw new Error("You are submitting a Fee Payer transaction but missing the feePayerAuthenticator");return r.apply(this,o)},t}function Tr(n,e,t){let r=t.value;return t.value=async function(...o){let[s]=o;if(s.transaction.feePayerAddress&&!s.feePayerPublicKey)throw new Error("You are simulating a Fee Payer transaction but missing the feePayerPublicKey");return r.apply(this,o)},t}var mt=class{constructor(e){this.config=e}async simple(e){return dr({aptosConfig:this.config,...e})}async multiAgent(e){return dr({aptosConfig:this.config,...e})}};M([Tr],mt.prototype,"simple",1),M([Tr],mt.prototype,"multiAgent",1);var yt=class{constructor(e){this.config=e}async simple(e){return xn({aptosConfig:this.config,...e})}async multiAgent(e){return xn({aptosConfig:this.config,...e})}};M([hr],yt.prototype,"simple",1),M([hr],yt.prototype,"multiAgent",1);var _eventemitter3 = require('eventemitter3'); var _eventemitter32 = _interopRequireDefault(_eventemitter3);var Pn=()=>Math.floor(Date.now()/1e3),En= exports.AccountSequenceNumber =class{constructor(e,t,r,o,s){this.lastUncommintedNumber=null;this.currentNumber=null;this.lock=!1;this.aptosConfig=e,this.account=t,this.maxWaitTime=r,this.maximumInFlight=o,this.sleepTime=s}async nextSequenceNumber(){for(;this.lock;)await Ue(this.sleepTime);this.lock=!0;let e=BigInt(0);try{if((this.lastUncommintedNumber===null||this.currentNumber===null)&&await this.initialize(),this.currentNumber-this.lastUncommintedNumber>=this.maximumInFlight){await this.update();let t=Pn();for(;this.currentNumber-this.lastUncommintedNumber>=this.maximumInFlight;)await Ue(this.sleepTime),Pn()-t>this.maxWaitTime?(console.warn(`Waited over 30 seconds for a transaction to commit, resyncing ${this.account.accountAddress.toString()}`),await this.initialize()):await this.update()}e=this.currentNumber,this.currentNumber+=BigInt(1)}catch(t){console.error("error in getting next sequence number for this account",t)}finally{this.lock=!1}return e}async initialize(){let{sequence_number:e}=await de({aptosConfig:this.aptosConfig,accountAddress:this.account.accountAddress});this.currentNumber=BigInt(e),this.lastUncommintedNumber=BigInt(e)}async update(){let{sequence_number:e}=await de({aptosConfig:this.aptosConfig,accountAddress:this.account.accountAddress});return this.lastUncommintedNumber=BigInt(e),this.lastUncommintedNumber}async synchronize(){if(this.lastUncommintedNumber!==this.currentNumber){for(;this.lock;)await Ue(this.sleepTime);this.lock=!0;try{await this.update();let e=Pn();for(;this.lastUncommintedNumber!==this.currentNumber;)Pn()-e>this.maxWaitTime?(console.warn(`Waited over 30 seconds for a transaction to commit, resyncing ${this.account.accountAddress.toString()}`),await this.initialize()):(await Ue(this.sleepTime),await this.update())}catch(e){console.error("error in synchronizing this account sequence number with the one on chain",e)}finally{this.lock=!1}}}};var At=class{constructor(){this.queue=[];this.pendingDequeue=[];this.cancelled=!1}enqueue(e){if(this.cancelled=!1,this.pendingDequeue.length>0){_optionalChain([this, 'access', _157 => _157.pendingDequeue, 'access', _158 => _158.shift, 'call', _159 => _159(), 'optionalAccess', _160 => _160.resolve, 'call', _161 => _161(e)]);return}this.queue.push(e)}async dequeue(){return this.queue.length>0?Promise.resolve(this.queue.shift()):new Promise((e,t)=>{this.pendingDequeue.push({resolve:e,reject:t})})}isEmpty(){return this.queue.length===0}cancel(){this.cancelled=!0,this.pendingDequeue.forEach(async({reject:e})=>{e(new ft("Task cancelled"))}),this.pendingDequeue=[],this.queue.length=0}isCancelled(){return this.cancelled}pendingDequeueLength(){return this.pendingDequeue.length}},ft=class extends Error{};var qs="fulfilled",$s= exports.TransactionWorkerEventsEnum =(s=>(s.TransactionSent="transactionSent",s.TransactionSendFailed="transactionSendFailed",s.TransactionExecuted="transactionExecuted",s.TransactionExecutionFailed="transactionExecutionFailed",s.ExecutionFinish="executionFinish",s))($s||{}),In= exports.TransactionWorker =class extends _eventemitter32.default{constructor(t,r,o=30,s=100,i=10){super();this.taskQueue=new At;this.transactionsQueue=new At;this.outstandingTransactions=new At;this.sentTransactions=[];this.executedTransactions=[];this.aptosConfig=t,this.account=r,this.started=!1,this.accountSequnceNumber=new En(t,r,o,s,i)}async submitNextTransaction(){try{for(;;){let t=await this.accountSequnceNumber.nextSequenceNumber();if(t===null)return;let r=await this.generateNextTransaction(this.account,t);if(!r)return;let o=Ut({aptosConfig:this.aptosConfig,transaction:r,signer:this.account});await this.outstandingTransactions.enqueue([o,t])}}catch(t){if(t instanceof ft)return;throw new Error(`Submit transaction failed for ${this.account.accountAddress.toString()} with error ${t}`)}}async processTransactions(){try{for(;;){let t=[],r=[],[o,s]=await this.outstandingTransactions.dequeue();for(t.push(o),r.push(s);!this.outstandingTransactions.isEmpty();)[o,s]=await this.outstandingTransactions.dequeue(),t.push(o),r.push(s);let i=await Promise.allSettled(t);for(let a=0;a<i.length&&a<r.length;a+=1){let c=i[a];s=r[a],c.status===qs?(this.sentTransactions.push([c.value.hash,s,null]),this.emit("transactionSent",{message:`transaction hash ${c.value.hash} has been committed to chain`,transactionHash:c.value.hash}),await this.checkTransaction(c,s)):(this.sentTransactions.push([c.status,s,c.reason]),this.emit("transactionSendFailed",{message:`failed to commit transaction ${this.sentTransactions.length} with error ${c.reason}`,error:c.reason}))}this.emit("executionFinish",{message:`execute ${i.length} transactions finished`})}}catch(t){if(t instanceof ft)return;throw new Error(`Process execution failed for ${this.account.accountAddress.toString()} with error ${t}`)}}async checkTransaction(t,r){try{let o=[];o.push(tt({aptosConfig:this.aptosConfig,transactionHash:t.value.hash}));let s=await Promise.allSettled(o);for(let i=0;i<s.length;i+=1){let a=s[i];a.status===qs?(this.executedTransactions.push([a.value.hash,r,null]),this.emit("transactionExecuted",{message:`transaction hash ${a.value.hash} has been executed on chain`,transactionHash:t.value.hash})):(this.executedTransactions.push([a.status,r,a.reason]),this.emit("transactionExecutionFailed",{message:`failed to execute transaction ${this.executedTransactions.length} with error ${a.reason}`,error:a.reason}))}}catch(o){throw new Error(`Check transaction failed for ${this.account.accountAddress.toString()} with error ${o}`)}}async push(t,r){this.transactionsQueue.enqueue([t,r])}async generateNextTransaction(t,r){if(this.transactionsQueue.isEmpty())return;let[o,s]=await this.transactionsQueue.dequeue();return A({aptosConfig:this.aptosConfig,sender:t.accountAddress,data:o,options:{...s,accountSequenceNumber:r}})}async run(){try{for(;!this.taskQueue.isCancelled();)await(await this.taskQueue.dequeue())()}catch(t){throw new Error(`Unable to start transaction batching: ${t}`)}}start(){if(this.started)throw new Error("worker has already started");this.started=!0,this.taskQueue.enqueue(()=>this.submitNextTransaction()),this.taskQueue.enqueue(()=>this.processTransactions()),this.run()}stop(){if(this.taskQueue.isCancelled())throw new Error("worker has already stopped");this.started=!1,this.taskQueue.cancel()}};var Un=class extends _eventemitter32.default{constructor(e){super(),this.config=e}start(e){let{sender:t}=e;this.account=t,this.transactionWorker=new In(this.config,t),this.transactionWorker.start(),this.registerToEvents()}push(e){let{data:t,options:r}=e;for(let o of t)this.transactionWorker.push(o,r)}registerToEvents(){this.transactionWorker.on("transactionSent",async e=>{this.emit("transactionSent",e)}),this.transactionWorker.on("transactionSendFailed",async e=>{this.emit("transactionSendFailed",e)}),this.transactionWorker.on("transactionExecuted",async e=>{this.emit("transactionExecuted",e)}),this.transactionWorker.on("transactionExecutionFailed",async e=>{this.emit("transactionExecutionFailed",e)}),this.transactionWorker.on("executionFinish",async e=>{this.emit("executionFinish",e)})}forSingleAccount(e){try{let{sender:t,data:r,options:o}=e;this.start({sender:t}),this.push({data:r,options:o})}catch(t){throw new Error(`failed to submit transactions with error: ${t}`)}}};var Kt=class{constructor(e){this.config=e,this.build=new Cn(this.config),this.simulate=new mt(this.config),this.submit=new yt(this.config),this.batch=new Un(this.config)}async getTransactions(e){return Eo({aptosConfig:this.config,...e})}async getTransactionByVersion(e){return Io({aptosConfig:this.config,...e})}async getTransactionByHash(e){return pn({aptosConfig:this.config,...e})}async isPendingTransaction(e){return Uo({aptosConfig:this.config,...e})}async waitForTransaction(e){return tt({aptosConfig:this.config,...e})}async getGasPriceEstimation(){return un({aptosConfig:this.config})}getSigningMessage(e){return Vo(e)}async publishPackageTransaction(e){return Ho({aptosConfig:this.config,...e})}async rotateAuthKey(e){return Qo({aptosConfig:this.config,...e})}sign(e){return Sn({...e})}signAsFeePayer(e){let{signer:t,transaction:r}=e;if(!r.feePayerAddress)throw new Error(`Transaction ${r} is not a Fee Payer transaction`);return r.feePayerAddress=t.accountAddress,Sn({signer:t,transaction:r})}async batchTransactionsForSingleAccount(e){try{let{sender:t,data:r,options:o}=e;this.batch.forSingleAccount({sender:t,data:r,options:o})}catch(t){throw new Error(`failed to submit transactions with error: ${t}`)}}async signAndSubmitTransaction(e){let{signer:t,transaction:r}=e;return Ut({aptosConfig:this.config,signer:t,transaction:r})}};var ee=class{constructor(e){this.config=new ln(e),this.account=new _t(this.config),this.ans=new Mt(this.config),this.coin=new Rt(this.config),this.digitalAsset=new Nt(this.config),this.event=new kt(this.config),this.faucet=new zt(this.config),this.fungibleAsset=new Ot(this.config),this.general=new Dt(this.config),this.staking=new Ft(this.config),this.transaction=new Kt(this.config)}};function me(n,e,t){Object.getOwnPropertyNames(e.prototype).forEach(r=>{let o=Object.getOwnPropertyDescriptor(e.prototype,r);o&&(o.value=function(...s){return this[t][r](...s)},Object.defineProperty(n.prototype,r,o))})}me(ee,_t,"account");me(ee,Mt,"ans");me(ee,Rt,"coin");me(ee,Nt,"digitalAsset");me(ee,kt,"event");me(ee,zt,"faucet");me(ee,Ot,"fungibleAsset");me(ee,Dt,"general");me(ee,Ft,"staking");me(ee,Kt,"transaction");exports.APTOS_BIP44_REGEX = ai; exports.APTOS_COIN = Vt; exports.APTOS_HARDENED_REGEX = ii; exports.Account = Ee; exports.AccountAddress = u; exports.AccountAuthenticator = H; exports.AccountAuthenticatorEd25519 = pe; exports.AccountAuthenticatorMultiEd25519 = en; exports.AccountAuthenticatorMultiKey = Xe; exports.AccountAuthenticatorSingleKey = se; exports.AccountAuthenticatorVariant = Cr; exports.AccountPublicKey = ce; exports.AccountSequenceNumber = En; exports.AddressInvalidReason = ni; exports.AnyPublicKey = q; exports.AnyPublicKeyVariant = Pr; exports.AnySignature = B; exports.AnySignatureVariant = Er; exports.Aptos = ee; exports.AptosApiError = ye; exports.AptosApiType = $t; exports.AptosConfig = ln; exports.AuthenticationKey = K; exports.Bool = I; exports.CKDPriv = $r; exports.ChainId = it; exports.DEFAULT_MAX_GAS_AMOUNT = Rr; exports.DEFAULT_TXN_EXP_SEC_FROM_NOW = Nr; exports.DEFAULT_TXN_TIMEOUT_SEC = Lt; exports.DeriveScheme = js; exports.Deserializer = Br; exports.Ed25519Account = Ye; exports.Ed25519PrivateKey = Y; exports.Ed25519PublicKey = U; exports.Ed25519Signature = R; exports.EntryFunction = dt; exports.EntryFunctionBytes = jt; exports.FeePayerRawTransaction = _e; exports.FixedBytes = Oe; exports.HARDENED_OFFSET = Fr; exports.Hex = b; exports.HexInvalidReason = Js; exports.Identifier = E; exports.KeyType = ci; exports.MimeType = Rn; exports.ModuleId = St; exports.MoveAbility = Ir; exports.MoveFunctionVisibility = Qs; exports.MoveOption = Ce; exports.MoveString = w; exports.MoveVector = h; exports.MultiAgentRawTransaction = we; exports.MultiEd25519PublicKey = We; exports.MultiEd25519Signature = Be; exports.MultiKey = Jt; exports.MultiKeySignature = Qr; exports.MultiSig = Et; exports.MultiSigTransactionPayload = It; exports.Network = Xn; exports.NetworkToChainId = Yn; exports.NetworkToFaucetAPI = jn; exports.NetworkToIndexerAPI = Qn; exports.NetworkToNetworkName = jd; exports.NetworkToNodeAPI = Wn; exports.ParsingError = F; exports.ProcessorType = Le; exports.PublicKey = wt; exports.RAW_TRANSACTION_SALT = Gr; exports.RAW_TRANSACTION_WITH_DATA_SALT = kn; exports.RawTransaction = ie; exports.RawTransactionWithData = yn; exports.RoleType = Ws; exports.RotationProofChallenge = gn; exports.Script = Pt; exports.ScriptTransactionArgumentVariants = Tt; exports.Secp256k1PrivateKey = Fe; exports.Secp256k1PublicKey = fe; exports.Secp256k1Signature = he; exports.Serializable = d; exports.Serializer = ae; exports.Signature = X; exports.SignedTransaction = ge; exports.SigningScheme = xe; exports.SigningSchemeInput = Gn; exports.SingleKeyAccount = Ze; exports.StructTag = be; exports.TransactionAuthenticator = Te; exports.TransactionAuthenticatorEd25519 = nt; exports.TransactionAuthenticatorFeePayer = ot; exports.TransactionAuthenticatorMultiAgent = rt; exports.TransactionAuthenticatorMultiEd25519 = Zn; exports.TransactionAuthenticatorSingleSender = st; exports.TransactionAuthenticatorVariant = vr; exports.TransactionPayload = qe; exports.TransactionPayloadEntryFunction = vt; exports.TransactionPayloadMultiSig = Ct; exports.TransactionPayloadScript = xt; exports.TransactionPayloadVariants = Sr; exports.TransactionResponseType = Nn; exports.TransactionVariants = xr; exports.TransactionWorker = In; exports.TransactionWorkerEventsEnum = $s; exports.TypeTag = N; exports.TypeTagAddress = Q; exports.TypeTagBool = O; exports.TypeTagGeneric = G; exports.TypeTagParserError = v; exports.TypeTagParserErrorType = hi; exports.TypeTagReference = mn; exports.TypeTagSigner = Ke; exports.TypeTagStruct = l; exports.TypeTagU128 = ut; exports.TypeTagU16 = at; exports.TypeTagU256 = pt; exports.TypeTagU32 = ct; exports.TypeTagU64 = $; exports.TypeTagU8 = le; exports.TypeTagVariants = _r; exports.TypeTagVector = x; exports.U128 = re; exports.U16 = te; exports.U256 = oe; exports.U32 = ne; exports.U64 = k; exports.U8 = z; exports.aptosCoinStructTag = Nl; exports.aptosRequest = qt; exports.buildTransaction = ur; exports.checkOrConvertArgument = gt; exports.convertArgument = Fo; exports.deriveKey = Dn; exports.deriveTransactionType = Lo; exports.deserializeFromScriptArgument = yi; exports.ensureBoolean = On; exports.fetchEntryFunctionAbi = Mo; exports.findFirstNonSignerArg = Do; exports.generateMultiSignersSignedTransaction = vi; exports.generateRawTransaction = xi; exports.generateSignedTransaction = $o; exports.generateSignedTransactionForSimulation = Ko; exports.generateSigningMessage = pr; exports.generateTransactionPayload = wn; exports.generateTransactionPayloadWithABI = _n; exports.get = kr; exports.getAptosFullNode = j; exports.getAuthenticatorForSimulation = bn; exports.getFunctionParts = ar; exports.isBcsAddress = Tn; exports.isBcsBool = Jn; exports.isBcsFixedBytes = Ti; exports.isBcsString = er; exports.isBcsU128 = sr; exports.isBcsU16 = nr; exports.isBcsU256 = ir; exports.isBcsU32 = rr; exports.isBcsU64 = or; exports.isBcsU8 = tr; exports.isBlockMetadataTransactionResponse = pa; exports.isBool = Go; exports.isEd25519Signature = ga; exports.isEncodedEntryFunctionArgument = zo; exports.isFeePayerSignature = Aa; exports.isGenesisTransactionResponse = ua; exports.isLargeNumber = hn; exports.isMultiAgentSignature = ya; exports.isMultiEd25519Signature = fa; exports.isNull = ko; exports.isNumber = fn; exports.isPendingTransactionResponse = aa; exports.isScriptDataInput = Oo; exports.isSecp256k1Signature = ma; exports.isStateCheckpointTransactionResponse = da; exports.isString = lt; exports.isUserTransactionResponse = ca; exports.isValidBIP44Path = Kr; exports.isValidHardenedPath = qr; exports.isValidatorTransactionResponse = la; exports.mnemonicToSeed = Xt; exports.objectStructTag = W; exports.optionStructTag = Gl; exports.outOfRangeErrorMessage = ei; exports.paginateWithCursor = Ve; exports.parseTypeTag = $e; exports.post = zn; exports.postAptosFaucet = Or; exports.postAptosFullNode = He; exports.postAptosIndexer = zr; exports.promiseFulfilledStatus = qs; exports.request = Xs; exports.sign = qo; exports.splitPath = Lr; exports.standardizeTypeTags = Bo; exports.stringStructTag = S; exports.throwTypeMismatch = P; exports.validateNumberInRange = ve;
//# sourceMappingURL=index.js.map